import pickle
import streamlit as st
import requests
from streamlit_navigation_bar import st_navbar
import random
import json
import os

#########################################################################################################################################################

# Function to read credentials from external file
def load_credentials2():
    try:
        with open("credentials2.json", "r") as file:
            return json.load(file)
    except FileNotFoundError:
        return {}

# Function to save credentials to external file
def save_credentials2(credentials2):
    with open("credentials2.json", "w") as file:
        json.dump(credentials2, file)

# Function to initialize session state
def initialize_session_state():
    if 'logged_in' not in st.session_state:
        st.session_state.logged_in = False
    if 'username' not in st.session_state:
        st.session_state.username = None

def login(credentials2):
    initialize_session_state()
    if not st.session_state.logged_in:
        st.subheader("Login")
        username = st.text_input("Username")
        password = st.text_input("Password", type="password")
        if st.button("Login"):
            if username in credentials2 and credentials2[username]["password"] == password:  
                st.session_state.logged_in = True
                st.session_state.username = username
                st.session_state.favorites = credentials2[username].get("favorites", [])
                st.experimental_rerun()
            else:
                st.error("Incorrect username or password")

def signup(credentials2):
    st.subheader("Sign Up")
    new_username = st.text_input("New Username")
    new_password = st.text_input("New Password", type="password")
    confirm_password = st.text_input("Confirm Password", type="password")
    name = st.text_input("Name")
    email = st.text_input("Email")
    phone_number = st.text_input("Phone Number")
    uploaded_file = st.file_uploader("Choose a profile picture", type=["jpg", "jpeg", "png"])

    if st.button("Sign Up"):
        if new_password != confirm_password:
            st.error("Passwords do not match")
        elif new_username in credentials2:
            st.error("Username already exists")
        else:
            st.success("Sign up successful! You can now login.")
            credentials2[new_username] = {
                "password": new_password,
                "name": name,
                "email": email,
                "phone_number": phone_number,
                "profile_picture": save_profile_picture(uploaded_file, new_username) if uploaded_file else None
            }
            save_credentials2(credentials2)

#########################################################################################################################################################

def save_profile_picture(uploaded_file, username):
    if not os.path.exists("profile_pictures"):
        os.makedirs("profile_pictures")

    file_path = f"profile_pictures/{username}_profile_picture.jpg"
    with open(file_path, "wb") as file:
        file.write(uploaded_file.read())
    return file_path

def sidebar(credentials2):
    # Count the number of users
    total_users = len(credentials2)
    st.sidebar.write("# :red[Total Users Count: ]", total_users)
    
    st.sidebar.title(":red[Account Info]")
    st.sidebar.markdown(f"**Username:** {st.session_state.username}")
    if st.session_state.username in credentials2:
        user_info = credentials2[st.session_state.username]
        st.sidebar.markdown(f"**Name:** {user_info['name']}")
        st.sidebar.markdown(f"**Phone Number:** {user_info['phone_number']}")
        st.sidebar.markdown(f"**Email:** {user_info['email']}")
        
        profile_picture_path = user_info.get("profile_picture")
        if profile_picture_path and os.path.exists(profile_picture_path):
            with open(profile_picture_path, "rb") as file:
                profile_picture = file.read()
            st.sidebar.image(profile_picture, caption="Profile Picture", use_column_width=True)
            st.sidebar.subheader(":red[Change Profile Picture]")
            uploaded_file = st.sidebar.file_uploader("Edit", type=["jpg", "jpeg", "png"])
            if uploaded_file:
                new_picture_path = save_profile_picture(uploaded_file, st.session_state.username)
                user_info["profile_picture"] = new_picture_path
                save_credentials2(credentials2)
                st.sidebar.write("Profile picture changed! Click the button below to reload.")
                if st.sidebar.button("Reload"):
                    st.experimental_rerun()
        else:
            st.sidebar.subheader("Upload Profile Picture")
            uploaded_file = st.sidebar.file_uploader("Choose a profile picture", type=["jpg", "jpeg", "png"])
            if uploaded_file:
                credentials2[st.session_state.username]["profile_picture"] = save_profile_picture(uploaded_file, st.session_state.username)
                save_credentials2(credentials2)
                st.sidebar.write("Photo uploaded! Click the button below to reload.")
                if st.sidebar.button("Reload"):
                    st.experimental_rerun()

        if st.sidebar.button("Log out"):
            st.session_state.logged_in = False

#########################################################################################################################################################W

def main():
    credentials2 = load_credentials2()
    initialize_session_state()  # Initialize session state

    if not st.session_state.logged_in:  # Render login/signup only if not logged in
        st.markdown("<h1 style='text-align: center; color: #c22d23;'>Movie Recommendation System</h1>", unsafe_allow_html=True)
        st.markdown("<h3 style='text-align: center; color: #5796fa;'>Login or Sign Up Here</h3>", unsafe_allow_html=True)
        selection = st.radio("Select Action", ["Login", "Sign Up"])

        if selection == "Login":
            login(credentials2)
        elif selection == "Sign Up":
            signup(credentials2)
            
    else:  
        ###############################################################################################################################################

        #def generate_random_number():
        #    return random.randint(100, 200)

        movie_ids = [8193, 335874, 8195, 16388, 5, 8197, 8198, 40963, 8202, 11, 12, 13, 14, 8204, 16, 18, 19, 20, 22, 16406, 24, 25, 122906, 28, 8224, 33, 17917, 35, 164457, 122917, 38, 16428, 24621, 16433, 41009, 98357, 55, 8247, 16441, 58, 59, 32823, 62, 9782, 65, 66, 16448, 68, 69, 70, 71, 98369, 73, 74, 75, 76, 77, 78, 79, 80, 8265, 8271, 83, 8272, 85, 8273, 87, 16471, 89, 90, 24662, 24663, 8285, 24664, 95, 96, 32856, 98, 8291, 100, 8292, 8293, 103, 104, 105, 106, 107, 24684, 254024, 111, 114, 115, 116, 117, 118, 120, 121, 122, 204922, 16508, 128, 129, 8321, 336004, 134, 8326, 8328, 137, 8329, 16523, 141, 142, 8337, 146, 8338, 73873, 149, 41110, 106646, 152, 153, 154, 155, 8346, 157, 16538, 180383, 226354, 161, 162, 163, 8355, 165, 8358, 167, 168, 169, 170, 8363, 172, 173, 174, 8367, 176, 177, 16558, 179, 180, 8373, 182, 8374, 184, 16564, 186, 187, 41144, 189, 193, 194, 8386, 196, 197, 8390, 199, 200, 201, 16577, 203, 205, 207, 73935, 73937, 49365, 214, 215, 8408, 217, 218, 219, 8409, 8413, 65749, 223, 8416, 16608, 226, 227, 24803, 65759, 16614, 231, 16617, 235, 8427, 16619, 238, 239, 240, 16620, 242, 243, 8435, 245, 98549, 248, 16633, 41210, 251, 252, 253, 254, 73981, 41216, 257, 16642, 16643, 8452, 261, 90369, 98566, 8456, 8457, 98568, 16651, 268, 8461, 16653, 57612, 272, 41233, 274, 8467, 245916, 277, 278, 279, 280, 8469, 8470, 271969, 284, 285, 288, 289, 41248, 291, 292, 24869, 49444, 8487, 296, 297, 298, 8488, 8489, 280381, 302, 90414, 306, 16690, 309, 310, 311, 147767, 314, 147773, 319, 320, 321, 322, 41283, 49471, 326, 327, 49478, 329, 330, 331, 332, 205126, 334, 335, 24913, 338, 33106, 342, 16727, 8536, 345, 346, 17979, 348, 106845, 350, 8545, 172385, 74084, 41317, 262500, 172391, 262504, 385383, 364, 24940, 49517, 49519, 49520, 49521, 49524, 49526, 49527, 156022, 377, 49529, 49530, 380, 16769, 24961, 387, 388, 389, 33155, 391, 392, 393, 8584, 395, 8587, 16781, 398, 24973, 400, 401, 8592, 403, 404, 16784, 24977, 262543, 408, 409, 24985, 411, 414, 415, 205220, 421, 41382, 423, 424, 425, 8618, 8619, 8617, 429, 33196, 431, 328111, 433, 435, 436, 440, 41402, 33217, 451, 8643, 453, 454, 455, 8645, 8649, 57800, 139715, 462, 464, 8656, 468, 470, 473, 8665, 16857, 16858, 8669, 41436, 479, 480, 41439, 16866, 8675, 8676, 16869, 41446, 16871, 57825, 489, 8681, 25066, 492, 66025, 426469, 496, 497, 8688, 500, 172533, 503, 504, 16888, 8698, 507, 508, 509, 510, 8699, 512, 41469, 188927, 16899, 254470, 41479, 254472, 205321, 522, 115210, 524, 525, 526, 16911, 41488, 254473, 301325, 57876, 533, 534, 535, 164372, 25113, 539, 540, 542, 544, 546, 547, 41508, 549, 550, 8741, 8744, 41513, 41515, 25132, 557, 558, 559, 131631, 562, 563, 131634, 568, 573, 576, 577, 578, 579, 580, 581, 582, 49730, 584, 585, 586, 587, 588, 8780, 590, 591, 592, 593, 594, 595, 25166, 597, 598, 57943, 601, 602, 603, 604, 605, 606, 607, 608, 609, 16988, 16991, 612, 613, 16995, 615, 616, 617, 8810, 619, 16996, 621, 622, 8814, 25195, 25196, 8818, 627, 628, 629, 630, 254128, 25208, 25209, 634, 49787, 25212, 639, 640, 641, 642, 8831, 644, 8834, 646, 8835, 8836, 8839, 650, 8838, 652, 8840, 654, 8847, 8848, 657, 658, 8842, 660, 8849, 8854, 663, 664, 8850, 666, 667, 668, 8859, 670, 671, 672, 673, 674, 675, 676, 8869, 8870, 679, 680, 681, 682, 8871, 8872, 8874, 686, 687, 688, 8875, 8879, 691, 692, 693, 694, 8883, 8885, 246449, 698, 699, 700, 33468, 702, 703, 704, 49852, 58048, 707, 708, 709, 710, 711, 712, 713, 714, 58051, 82631, 8909, 164558, 361159, 385736, 8913, 8914, 352978, 8916, 8920, 17113, 8922, 74457, 82650, 82654, 139998, 25312, 74465, 459488, 17127, 744, 745, 746, 747, 17130, 33511, 8942, 17134, 752, 8944, 754, 755, 756, 17139, 82675, 82679, 8952, 8953, 762, 82682, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 8960, 8961, 8963, 8966, 8967, 8968, 8970, 25350, 782, 783, 8976, 8975, 8978, 786, 787, 788, 790, 8981, 792, 8982, 794, 795, 796, 8984, 8987, 8988, 17182, 801, 802, 17186, 17187, 805, 8998, 807, 808, 809, 810, 811, 812, 813, 8999, 9007, 816, 9009, 817, 818, 9012, 819, 820, 821, 824, 9016, 826, 9013, 42497, 9021, 9022, 9023, 394047, 834, 9026, 9027, 837, 9030, 838, 9032, 840, 841, 9029, 9036, 844, 846, 9034, 848, 849, 9042, 9043, 850, 853, 854, 855, 9045, 857, 25428, 859, 860, 9053, 861, 862, 863, 864, 865, 9059, 866, 868, 869, 41823, 872, 873, 874, 9067, 33644, 41830, 879, 9072, 881, 9074, 9075, 17264, 25461, 25462, 887, 888, 889, 50035, 50037, 58233, 17277, 230266, 9087, 246655, 9089, 21345, 33667, 9092, 9093, 9095, 9096, 905, 17287, 907, 9099, 9100, 33676, 287625, 9104, 913, 74643, 920, 921, 924, 925, 926, 927, 928, 33693, 312221, 66468, 41894, 935, 345003, 943, 944, 25520, 947, 948, 17332, 950, 951, 17334, 953, 954, 955, 956, 957, 17339, 91070, 254904, 17345, 91076, 295886, 205775, 978, 979, 50135, 985, 987, 990, 17379, 271331, 74725, 295914, 76726, 91122, 9208, 270487, 1018, 17403, 1024, 361475, 238603, 140300, 17431, 238615, 74777, 1051, 17436, 295964, 361505, 181283, 25636, 9257, 222250, 25643, 9260, 238636, 82990, 66607, 1073, 9266, 42033, 9268, 239563, 9271, 9273, 9275, 9276, 9277, 58428, 8357, 1088, 9279, 1090, 1091, 9280, 9281, 9282, 9285, 9286, 8359, 9288, 9289, 9290, 9291, 9292, 1103, 9294, 9297, 25678, 33870, 181330, 402515, 9302, 9303, 9304, 9306, 1116, 9310, 9311, 9312, 9313, 239571, 1123, 1124, 1125, 9315, 25704, 84892, 239573, 9327, 9331, 33909, 9334, 9335, 9336, 25719, 9339, 58492, 9341, 9342, 42109, 9344, 9348, 9350, 9352, 9353, 132232, 9355, 1164, 1165, 9357, 9358, 9360, 9361, 9362, 50321, 9366, 9367, 9372, 9374, 287903, 115872, 296096, 9378, 25763, 296098, 9381, 296099, 9383, 9384, 17577, 17578, 9387, 9388, 9389, 9390, 25769, 9392, 50348, 91314, 9396, 50357, 9398, 50359, 9400, 25784, 25786, 1213, 9408, 25793, 9414, 9416, 17610, 42188, 287948, 9422, 58574, 9424, 9425, 66767, 9427, 9428, 9429, 9430, 17622, 279759, 9433, 9434, 132316, 1245, 1246, 9437, 1248, 9440, 1250, 1251, 9441, 9443, 9444, 1255, 9447, 1257, 9448, 1259, 9449, 9451, 1262, 9452, 9454, 1265, 1266, 9455, 1268, 9457, 9459, 1271, 1272, 1273, 9464, 9466, 17654, 9469, 9470, 9471, 9472, 9473, 1282, 17663, 9476, 58626, 9481, 132363, 9486, 9487, 9488, 9489, 9490, 189711, 9493, 34069, 9495, 50456, 75033, 304410, 181533, 9502, 9504, 255266, 107811, 9509, 34086, 9513, 9515, 9516, 9517, 17707, 17708, 17709, 17710, 17711, 34099, 34101, 9526, 58680, 42297, 34106, 9531, 9532, 9533, 58882, 9535, 50497, 9541, 17734, 9543, 9544, 107846, 270554, 9548, 9549, 9550, 1359, 1360, 9552, 263503, 9555, 1365, 1366, 9557, 1368, 1369, 1370, 9562, 1372, 9563, 9566, 9567, 378200, 1378, 9570, 9571, 1381, 1382, 9573, 9574, 9576, 17768, 34152, 42345, 1389, 9582, 1391, 9583, 25968, 50538, 9587, 9588, 50544, 50546, 9591, 25975, 9593, 1402, 9594, 206197, 378237, 9598, 25983, 1408, 9600, 66942, 9603, 1412, 17795, 157058, 1415, 9607, 1417, 9610, 206213, 9613, 1422, 9614, 1424, 9615, 9616, 1427, 1428, 1429, 1430, 9618, 9619, 9620, 9621, 1435, 9623, 9624, 9625, 1439, 1440, 9626, 9631, 1443, 17820, 9637, 26022, 75174, 9641, 17834, 50601, 1452, 9644, 9645, 9647, 198062, 116149, 9654, 9655, 9656, 26039, 222649, 9659, 50620, 9662, 9664, 9665, 91586, 9667, 9671, 9672, 9675, 9676, 206284, 9678, 1487, 9679, 107985, 9682, 1491, 9683, 1493, 1494, 1495, 9685, 1497, 9686, 1499, 9689, 9691, 9693, 17880, 50647, 9697, 312793, 9700, 9701, 9702, 9703, 9705, 9707, 9709, 9713, 99826, 1523, 9715, 9716, 9718, 17908, 9725, 9726, 1535, 9728, 1537, 1538, 9729, 9730, 9731, 1542, 17926, 1544, 9737, 1546, 1547, 1548, 9741, 1550, 1551, 34314, 50698, 9746, 1555, 99861, 140823, 1562, 9754, 280092, 9759, 9760, 34335, 9762, 1571, 1572, 1573, 1574, 9763, 1576, 1577, 1578, 1579, 9766, 1581, 9767, 9770, 1584, 1585, 1586, 1587, 1588, 9772, 1590, 1591, 9776, 1593, 9778, 9779, 9781, 1597, 1598, 1599, 9783, 9787, 9792, 9793, 9794, 9798, 9799, 9800, 9801, 9802, 17994, 9804, 1613, 9806, 17995, 91721, 9809, 206412, 1619, 1620, 1621, 9813, 83542, 1624, 9816, 24746, 9819, 42586, 9821, 9822, 9823, 9824, 9825, 9826, 1635, 1636, 1637, 9829, 1639, 1640, 9833, 1642, 24748, 9836, 1645, 1646, 9837, 1648, 1649, 9839, 1651, 9842, 34417, 157293, 1656, 9849, 18041, 42618, 362105, 18045]
        adv_ids = [11,18,22,58,62,74,79,85,87,89,95,98,105,106,118,120,121,122,128,129,134,146,152,154,157,165,168,172,173,174,193,196,199,200,201,217,253,254,285,329,330,331,332,387,395,411,421,425,435,479,503,526,533,558,559,563,576,578,580,581,587,593,601,602,604,605,607,608,630,644,646,652,657,658,660,664,667,668,671,672,673,674,675,681,682,691,698,699,700,707,708,709,710,714,762,767,772,808,809,810,811,812,817,841,849,861,869,879,920,943,944,947,950,954,955,956,978,1251,1265,1271,1273,1368,1369,1370,1381,1408,1452,1495,1497,1499,1537,1579,1593,1635,1637,1639,1648,1649,1656,1669,1685,1724,1726,1729,1734,1735,1771,1832,1858,1865,1878,1891,1892,1893,1894,1895,1907,1911,1924,1930,1956,1966,1979,1995,1996,1997,2023,2059,2080,2114,2119,2135,2157,2207,2268,2270,2309,2310,2312,2320,2395,2454,2486,2493,2661,2756,2989,3132,3989,4107,4327,4442,4476,4515,4688,4723,4824,4935,5137,5172,5255,5353,5494,5503,5550,5551,5559,5689,5769,5915,5925,6038,6068,6116,6278,6415,6519,6520,6795,6978,7305,7364,7450,7451,7453,7484,7512,8009,8053,8054,8195,8204,8247,8326,8355,8358,8367,8373,8427,8487,8536,8584,8592,8619,8676,8810,8814,8850,8854,8916,8961,8966,8975,8987,9013,9016,9023,9036,9042,9053,9093,9096,9208,9266,9273,9285,9288,9290,9292,9313,9334,9341,9342,9350,9355,9360,9361,9381,9387,9392,9396,9416,9433,9447,9448,9449,9457,9471,9476,9486,9487,9488,9502,9531,9543,9550,9555,9562,9570,9588,9593,9607,9610,9618,9619,9620,9625,9626,9631,9637,9659,9662,9664,9671,9683,9691,9703,9759,9760,9766,9802,9804,9806,9822,9824,9826,9837,9839,9896,9906,9922,9952,9954,9975,9978,9992,10003,10047,10054,10061,10077,10090,10105,10117,10136,10138,10140,10159,10188,10191,10192,10195,10196,10199,10204,10214,10315,10329,10336,10339,10386,10413,10448,10488,10501,10528,10530,10550,10586,10603,10628,10643,10674,10724,10762,10764,10783,10786,10803,10861,10865,10871,10956,10991,10996,10999,11024,11153,11165,11176,11194,11199,11212,11228,11237,11253,11260,11282,11342,11358,11359,11362,11370,11375,11398,11411,11451,11459,11469,11551,11576,11583,11619,11637,11658,11667,11676,11678,11679,11688,11780,11818,11866,11876,11888,11904,11967,11968,11969,11983,12138,12144,12155,12227,12244,12279,12289,12403,12437,12484,12589,12610,12704,12837,13001,13053,13064,13155,13191,13335,13475,13491,13523,13600,13811,13836,13853,13888,13938,13950,14043,14120,14160,14161,14164,14175,14199,14317,14324,14351,14405,14411,14560,14623,14869,14873,15028,15067,15070,15074,15173,15268,15365,15511,15512,15875,15907,15927,16016,16320,16340,16353,16433,16608,16651,16690,16866,17043,17130,17134,17186,17264,17339,17379,17578,17610,17711,17834,18162,18239,18357,18360,18808,18823,18828,18885,18886,19585,19933,19995,20406,20483,20526,20542,20662,20766,20856,21311,21512,21755,22102,22538,22972,23048,23069,23685,23759,24021,24264,24418,24428,24746,24961,25353,25379,25388,25678,25763,26428,26672,26916,27022,27205,27380,27549,27551,27578,29339,32657,33106,33196,34584,34723,34813,34851,35073,35791,36355,36557,36643,36648,36657,36658,36668,36669,36670,36819,37232,37498,37724,37931,38356,38543,38665,38717,38985,39513,39514,41216,41317,41513,41515,43867,43884,44115,44264,44826,44833,44896,44912,45226,45650,46195,46256,46528,46529,47534,47890,47933,48463,49013,49021,49051,49519,49521,49529,49538,50321,50456,50620,52451,54138,55604,56292,57158,57165,57201,57800,58048,58233,58574,58595,59859,59860,59917,62177,62204,62206,62255,62676,62764,64686,68179,68721,68726,68728,68735,68737,68818,70160,70981,71805,72197,72431,72545,72559,72710,75612,76163,76170,76285,76338,76341,76349,76649,76757,77174,77459,77951,78698,79698,80274,81390,82690,82700,82702,82703,83770,86834,87101,87827,88751,91314,98549,98566,99861,100402,101299,102382,102651,102899,105864,109445,110683,116711,116745,118340,122917,123553,127585,129670,131631,131634,133931,135397,137106,138103,140300,145220,146631,147441,152747,153158,157336,157350,157841,158852,166424,168705,171424,171759,172385,172391,173931,177572,177677,181533,184315,188207,188927,201132,202575,203801,205775,206563,206647,208763,209112,210860,211672,223702,227707,227783,228165,228326,238603,245703,246449,251979,252360,253412,256040,257445,257932,258489,258509,262500,262504,266647,267935,270938,270946,271110,272878,274854,278927,280391,281957,283671,285783,286217,290595,291805,293660,294272,294512,297761,299687,300168,308531,309809,315011,322443,328387,333355,352978,367961,381902,385736,417859]
        action_ids = [11,18,22,24,58,79,85,87,89,90,95,96,98,104,106,111,120,121,122,134,146,154,155,157,169,172,174,180,187,193,197,199,200,201,217,218,253,254,268,272,277,280,285,296,306,314,319,326,330,331,332,346,348,364,387,393,395,414,415,435,440,479,503,507,525,534,540,557,558,559,562,563,584,602,603,604,605,607,608,612,616,619,646,657,658,660,664,667,668,670,679,681,682,691,698,699,700,707,708,709,710,714,744,752,754,755,787,792,834,841,849,855,861,865,869,924,943,944,954,955,956,1051,1103,1123,1250,1251,1266,1271,1368,1369,1370,1372,1408,1428,1452,1487,1493,1494,1495,1497,1499,1535,1537,1571,1572,1573,1574,1576,1577,1579,1593,1613,1619,1620,1635,1637,1639,1642,1656,1669,1687,1688,1701,1705,1724,1726,1729,1734,1735,1771,1858,1865,1880,1891,1892,1893,1894,1895,1911,1924,1927,1930,1946,1948,1966,1969,1979,1995,1996,2008,2024,2034,2043,2048,2059,2080,2085,2088,2100,2110,2112,2114,2135,2140,2142,2162,2163,2185,2207,2310,2312,2320,2370,2453,2486,2501,2502,2503,2636,2669,2749,2756,2787,2789,3040,3132,3172,3482,3512,3536,3595,3989,4105,4107,4108,4327,4349,4421,4442,4474,4512,4515,4597,4614,4638,4723,4824,4911,4965,5137,5174,5175,5236,5353,5491,5503,5550,5551,5820,5822,6038,6068,6071,6073,6278,6415,6479,6519,6520,6623,6950,6968,6978,7191,7220,7288,7299,7304,7305,7347,7364,7446,7450,7451,7459,7461,7485,7515,7516,7737,7873,8007,8009,8011,8068,8077,8078,8195,8198,8202,8285,8292,8337,8373,8374,8409,8427,8456,8487,8536,8584,8592,8656,8681,8698,8810,8814,8831,8834,8838,8850,8854,8869,8870,8909,8914,8960,8961,8963,8975,8982,8987,9042,9053,9067,9074,9208,9257,9268,9271,9288,9289,9292,9311,9312,9313,9331,9334,9335,9341,9342,9348,9350,9355,9361,9362,9367,9381,9383,9387,9389,9400,9414,9416,9425,9433,9434,9448,9449,9455,9457,9470,9471,9476,9486,9488,9495,9509,9515,9516,9531,9543,9548,9550,9555,9562,9567,9570,9588,9593,9594,9610,9615,9618,9619,9620,9624,9625,9626,9631,9654,9659,9664,9679,9691,9693,9702,9703,9705,9737,9759,9760,9766,9770,9772,9798,9799,9802,9804,9806,9822,9823,9824,9825,9826,9829,9869,9882,9884,9890,9920,9923,9945,9946,9947,9950,9954,9955,9978,9989,10003,10016,10017,10022,10027,10034,10040,10045,10047,10048,10054,10061,10070,10074,10077,10090,10105,10117,10135,10136,10138,10159,10167,10179,10189,10195,10196,10204,10253,10329,10336,10350,10357,10366,10375,10388,10413,10425,10428,10431,10461,10477,10483,10528,10534,10535,10550,10555,10569,10589,10590,10610,10615,10622,10623,10632,10643,10656,10661,10705,10718,10724,10743,10762,10764,10771,10782,10783,10786,10796,10803,10861,10871,10877,10890,10914,10923,10935,10991,10999,11001,11022,11090,11128,11141,11165,11194,11199,11212,11228,11237,11358,11362,11370,11371,11375,11382,11398,11411,11412,11495,11509,11517,11519,11535,11536,11551,11564,11576,11658,11665,11667,11676,11678,11679,11690,11692,11702,11770,11817,11818,11835,11863,11866,11891,11904,11918,11935,11967,11968,11969,11983,12085,12088,12094,12096,12100,12106,12113,12123,12138,12142,12160,12207,12211,12227,12244,12277,12279,12289,12437,12484,12589,12610,12704,12770,13006,13025,13027,13051,13056,13064,13072,13154,13183,13184,13191,13197,13201,13282,13389,13408,13460,13475,13491,13495,13496,13498,13503,13805,13807,13809,13811,13836,13922,13938,13950,14034,14043,14161,14164,14324,14351,14392,14396,14538,14560,14576,14623,14736,14854,14869,14877,15049,15067,15070,15074,15092,15158,15173,15239,15268,15365,15644,15745,15797,15983,16016,16205,16290,16320,16353,16441,16577,16608,16651,16869,16911,16995,17043,17130,17134,17186,17339,17577,17622,17708,17711,18065,18360,18501,18533,18550,18712,18808,18823,18828,18869,18885,18886,19150,19187,19419,19457,19495,19585,19644,19803,19898,19901,19959,19995,20083,20391,20406,20483,20504,20526,20533,20662,20697,21338,21512,21610,21724,22301,22314,22488,22538,22600,22617,22787,22820,22821,22832,22907,22972,23172,23330,23483,23629,23631,23685,23742,23759,24206,24227,24264,24266,24418,24428,24575,24746,24748,24869,25209,25212,25388,25678,25763,25769,25941,26039,26268,26352,26389,26486,26843,26916,27022,27191,27205,27342,27380,27549,27573,27576,27578,27581,27582,27759,27936,28165,28932,29015,29076,29339,29427,30379,30596,31668,31867,32740,33106,33157,33196,33542,34314,34723,34769,34813,34851,35691,35791,35944,36557,36586,36643,36647,36648,36657,36658,36668,36669,36670,36955,37498,37710,37724,37737,37821,37834,37931,37958,38055,38153,38321,38322,38356,38543,38665,38717,38780,38940,38985,39180,39254,39349,39514,39833,40160,40505,40805,40914,41009,41154,41283,41317,42151,42807,43074,43090,43213,43630,43884,43935,43959,44048,44092,44147,44833,44865,44912,44943,45132,45138,45380,45610,46528,46529,47327,47534,47816,47933,47964,48138,48340,48572,48620,49010,49017,49021,49026,49040,49049,49051,49478,49521,49524,49526,49527,49529,49530,49538,49852,50456,51497,51955,51995,52015,52451,52520,53182,53502,54054,54138,56288,56292,56491,56930,57201,58233,58574,58626,59108,59440,59678,59859,59917,59961,59962,59965,59967,60304,61791,62177,62206,62255,62630,62835,63006,64686,64688,64690,65448,66607,67373,67913,68721,68724,68726,68735,68818,69382,69848,70006,70074,70435,70829,71469,71676,71679,72190,72331,72387,72431,72545,72559,72710,75174,75612,75674,76163,76170,76338,76341,76349,76640,76649,76757,77156,77866,77948,79698,80274,81005,81390,81796,82675,82682,82700,82702,87101,87421,87827,88751,91314,94329,94348,96721,97020,97430,98549,98566,99861,100402,101299,102362,102382,102651,102899,106747,107846,107985,109414,109424,109513,110415,112456,116613,116977,117251,117263,118340,118957,119283,119450,122917,123553,127493,127585,131634,134374,135397,136400,136795,136797,137094,137113,138103,140300,142061,144336,146198,146216,146227,146631,147441,147767,152747,152760,156022,157350,166424,168259,168530,168705,171424,173931,174751,177572,177677,182873,184315,187017,188207,188927,190859,192102,192141,192210,193756,198184,198663,203801,204082,205126,205775,206213,206647,208869,209112,216282,218043,224569,225574,228150,228967,240832,241254,241554,242166,244114,244316,244339,250066,252360,253450,253626,254128,254473,254904,256040,256092,256687,256740,256961,257088,257344,258489,260346,266396,267860,268920,270554,270938,271110,273481,274854,285923,287948,290555,290595,290864,291805,293660,294254,295914,297761,299552,300168,300671,300673,302156,302699,307081,308529,308531,312113,315011,316152,316727,317930,322194,323271,323675,323677,324668,325173,326284,327833,329540,332411,333355,335778,336004,342521,347755,352978,354624,356483,356841,361159,365222,367551,370464,375290,378237,380733,381902,385383,389425,407887,417859]
        anime_ids = [12,35,128,129,149,408,425,533,585,756,808,809,810,812,862,863,920,950,953,1273,2011,2062,2114,2300,2310,3170,3179,3509,3933,3989,4935,5255,5393,5559,6477,7443,7450,7484,7518,8355,8587,8885,8916,8920,8953,9016,9023,9297,9389,9408,9444,9473,9487,9502,9513,9662,9806,9836,9837,9906,9907,9928,9975,9982,9992,10137,10191,10192,10193,10198,10199,10315,10386,10501,10527,10530,10545,10555,10567,10674,10681,10715,10800,10865,10895,10982,10991,10996,11544,11619,11688,11802,11827,11836,12144,12244,12429,12589,12610,12819,13053,13158,13187,13682,13700,14160,14175,14317,14411,14444,14836,14873,15173,15511,15512,15655,16016,16110,16340,16508,16577,16690,16866,17578,17710,17711,17979,18937,18975,19405,19933,20352,20455,20542,20653,20694,22794,23398,23685,24034,24662,25353,26672,26963,36696,38055,38757,40688,41216,41513,41515,44896,46195,46256,49013,49444,49519,49948,49953,50135,50321,50359,51052,51162,51942,52010,52032,55301,57089,57800,59981,62177,62211,62214,65759,68179,72197,76492,77174,77459,77931,77950,77951,80321,81188,82690,82702,82703,93456,105864,109445,109451,116711,116977,126319,133931,137106,140300,142061,150540,153158,153518,159824,164372,170687,172385,172391,173931,175574,177572,192577,202575,211672,223702,227783,227973,228161,228165,228326,239897,257932,258509,270946,280391,283671,291270,292481,293644,294512,309809,328111,333355,367961,417859]
        crime_ids = [5,16,24,59,66,90,96,100,103,107,111,115,116,117,155,161,163,176,179,182,184,186,187,189,203,214,226,227,235,238,240,242,257,272,274,278,298,302,306,311,314,319,320,322,326,327,388,393,398,400,414,415,436,470,479,497,500,504,507,524,525,573,584,592,595,598,617,627,629,640,641,642,650,654,663,680,692,754,755,769,772,807,816,817,818,819,854,868,913,943,944,979,1051,1213,1248,1266,1359,1389,1415,1422,1427,1429,1493,1535,1537,1538,1542,1574,1598,1613,1619,1620,1637,1642,1645,1646,1651,1696,1701,1725,1830,1900,1948,1949,1958,1969,2001,2026,2034,2043,2069,2084,2085,2088,2112,2116,2118,2122,2140,2142,2148,2207,2252,2275,2661,2749,2757,2779,3093,3131,3172,3472,3489,3580,3766,4105,4108,4133,4147,4232,4327,4474,4477,4547,4551,4566,4597,4638,4657,4816,4824,4836,4911,4912,4959,4982,4997,5174,5175,5236,5503,5516,5550,5820,5854,5955,5971,6016,6071,6073,6687,6968,6973,6977,7220,7304,7347,7461,7485,7501,7516,7873,8012,8053,8060,8065,8068,8080,8141,8195,8197,8224,8285,8292,8321,8374,8461,8470,8592,8617,8643,8688,8744,8831,8838,8848,8883,8909,8961,8982,8984,8987,9013,9072,9074,9104,9257,9271,9273,9275,9277,9280,9281,9282,9303,9311,9335,9336,9344,9366,9367,9384,9400,9414,9430,9437,9455,9464,9470,9481,9490,9504,9509,9515,9516,9517,9533,9535,9548,9573,9594,9600,9615,9625,9631,9654,9679,9691,9702,9705,9737,9759,9762,9766,9799,9809,9829,9869,9879,9882,9923,9930,9932,9944,9950,9989,10017,10027,10029,10034,10090,10117,10147,10154,10167,10185,10220,10223,10279,10388,10391,10398,10410,10425,10428,10431,10461,10480,10528,10559,10569,10589,10622,10623,10628,10629,10632,10673,10731,10734,10743,10764,10782,10783,10833,10877,10878,10913,10955,11001,11022,11023,11027,11042,11109,11322,11323,11371,11386,11398,11412,11456,11478,11507,11509,11517,11546,11560,11564,11565,11576,11583,11592,11615,11679,11699,11702,11775,11798,11826,11835,11892,11904,11917,11967,11968,11975,12079,12085,12093,12096,12138,12149,12150,12192,12201,12245,12281,12612,12634,12690,12877,13006,13056,13150,13184,13197,13201,13250,13279,13389,13411,13429,13483,13536,13551,13685,13807,13809,13816,13820,13849,13937,13982,14043,14048,14112,14181,14195,14290,14396,14576,14823,14854,15049,15092,15365,15394,15670,16148,16155,16161,16433,16558,16608,16617,16991,17708,18065,18079,18206,18405,18487,18533,18713,18777,18869,18900,19457,19997,20055,20083,20794,21309,21338,21610,21612,22314,22479,22600,22787,22803,22821,22832,22907,23168,23483,23742,24066,24424,25066,25166,25376,25719,25941,26039,26268,26352,26389,26390,26618,26791,26837,27004,27360,27579,27581,27582,27936,28121,29122,29193,29920,30141,30246,31640,31867,33542,33909,34314,34335,34697,34769,34813,35689,36095,36334,36351,36593,36825,37137,37414,37495,37903,38322,38780,39514,39939,40805,41009,41283,41439,41894,42807,43213,43434,43539,43947,44945,45138,45226,45324,45610,46503,46727,47327,47502,48309,49026,49524,49526,49527,50348,51130,51497,51540,54054,54702,55903,57214,58233,58574,59859,60309,62630,62728,62835,63006,64559,64688,64689,64690,65754,66195,66468,67913,68727,68812,70074,70436,70670,72086,72387,73567,74536,74725,75656,75780,76640,77016,77866,77987,78814,81390,82525,82675,82682,84188,84329,86838,88794,92591,94329,94348,95755,97367,97614,98357,102362,103370,106646,106747,109091,109421,109431,116613,119283,119657,122081,125052,127493,134374,136400,136795,136797,136835,138832,144336,145220,146216,146227,146233,146238,152742,156022,158011,164457,168672,169917,171274,175291,181283,184346,185567,186935,187017,188166,190955,192102,192134,198184,199373,201088,206563,206647,208869,224569,241239,241554,241766,242582,244114,245916,254473,254904,256092,256591,257088,261023,263503,265208,266034,266396,267860,268920,273248,273481,276907,277519,284536,287948,290751,290864,291081,291805,297761,308639,310706,312113,313922,319910,325173,325789,328387,331190,332411,334527,336004,356216,356841,364083,366967,370464,376004,378237,389425]
        comedy_ids = [5,13,35,68,71,75,90,96,100,105,114,115,118,134,137,165,177,184,194,196,219,239,243,245,248,284,292,306,310,321,332,338,342,350,392,401,403,421,425,433,455,464,480,492,496,508,509,512,522,525,533,544,577,585,586,594,607,608,634,639,692,693,703,704,712,747,762,765,766,771,772,773,787,788,801,808,809,810,812,813,816,817,818,838,850,854,862,863,864,872,879,888,889,920,926,927,928,935,943,944,950,951,957,987,1257,1262,1268,1273,1378,1382,1389,1415,1493,1497,1499,1542,1544,1546,1547,1548,1550,1555,1574,1581,1584,1588,1593,1597,1599,1613,1621,1624,1636,1648,1649,1792,1809,1819,1824,1831,1832,1850,1878,1901,1909,1958,1961,1969,2018,2022,2056,2062,2069,2074,2084,2105,2110,2122,2123,2162,2185,2196,2255,2277,2280,2290,2292,2293,2294,2295,2300,2395,2493,2539,2610,2619,2621,2639,2642,2661,2687,2698,2752,2755,2757,2770,2771,2779,2830,2898,2907,2925,2959,2976,3028,3034,3049,3050,3062,3078,3080,3082,3083,3132,3172,3179,3587,3638,3981,3989,4011,4032,4244,4248,4256,4257,4258,4327,4379,4380,4442,4474,4523,4551,4599,4638,4723,4806,4912,4942,4944,4951,4953,4964,4967,5072,5172,5174,5175,5178,5236,5393,5516,5559,5722,5759,5769,5854,5900,5966,5971,5994,6007,6020,6038,6068,6073,6116,6282,6415,6435,6439,6477,6488,6519,6538,6552,6557,6575,6615,6877,6957,6961,6963,6964,6978,7278,7288,7301,7303,7326,7350,7364,7443,7446,7453,7510,7512,7516,7518,7552,7553,7942,7973,8012,8051,8141,8193,8265,8273,8285,8321,8326,8346,8355,8359,8363,8386,8390,8427,8435,8457,8467,8469,8487,8488,8545,8584,8592,8618,8669,8675,8676,8699,8780,8835,8839,8849,8859,8869,8871,8872,8874,8916,8920,8944,8952,8961,8970,8976,8998,9007,9012,9013,9021,9023,9026,9027,9029,9032,9034,9035,9043,9059,9067,9072,9074,9087,9089,9099,9104,9260,9273,9275,9277,9279,9285,9290,9291,9292,9297,9304,9310,9327,9336,9339,9352,9353,9372,9374,9384,9388,9390,9396,9398,9408,9414,9416,9427,9428,9429,9430,9434,9440,9447,9448,9449,9451,9452,9454,9464,9466,9470,9471,9472,9473,9486,9487,9489,9490,9493,9502,9513,9515,9526,9531,9535,9541,9548,9557,9571,9574,9576,9582,9583,9591,9593,9598,9600,9603,9607,9614,9618,9621,9637,9641,9644,9647,9655,9662,9671,9675,9678,9683,9685,9686,9689,9707,9713,9716,9718,9726,9737,9760,9767,9776,9778,9779,9781,9794,9801,9809,9821,9824,9825,9836,9842,9849,9870,9880,9889,9890,9893,9894,9895,9896,9899,9900,9903,9906,9907,9919,9928,9930,9932,9942,9950,9955,9957,9962,9969,9975,9981,9982,9986,9988,9991,10012,10013,10022,10025,10029,10030,10034,10040,10050,10054,10067,10070,10071,10073,10074,10090,10096,10115,10117,10136,10137,10147,10152,10154,10156,10159,10162,10179,10184,10186,10187,10188,10189,10192,10193,10201,10202,10204,10208,10212,10214,10215,10218,10246,10288,10312,10313,10314,10315,10317,10327,10330,10353,10358,10364,10368,10377,10385,10393,10402,10414,10416,10426,10437,10439,10468,10471,10472,10478,10480,10481,10488,10490,10501,10521,10535,10555,10557,10563,10564,10569,10571,10588,10589,10591,10603,10610,10611,10615,10622,10625,10628,10634,10642,10646,10658,10661,10663,10678,10683,10707,10708,10710,10715,10719,10735,10739,10743,10748,10756,10758,10760,10761,10762,10765,10771,10773,10776,10783,10806,10808,10833,10878,10890,10913,10914,10925,10934,10947,10956,10970,10981,10982,10985,10992,10996,11001,11004,11007,11011,11013,11024,11025,11042,11066,11072,11090,11091,11129,11130,11132,11137,11141,11153,11172,11176,11191,11199,11212,11217,11219,11229,11232,11240,11247,11249,11260,11282,11283,11284,11287,11302,11308,11323,11342,11353,11354,11363,11374,11375,11382,11395,11397,11404,11431,11446,11451,11452,11453,11459,11467,11469,11517,11519,11529,11543,11545,11546,11551,11561,11565,11576,11592,11598,11619,11622,11624,11631,11635,11637,11638,11648,11665,11676,11687,11688,11692,11770,11775,11812,11817,11823,11836,11843,11858,11870,11887,11888,11891,11908,11918,11932,11934,11956,11959,11971,11977,12079,12085,12090,12094,12096,12107,12109,12120,12133,12138,12153,12154,12158,12177,12182,12183,12193,12207,12220,12257,12277,12279,12312,12404,12454,12479,12486,12508,12535,12555,12569,12573,12589,12596,12610,12620,12621,12634,12657,12658,12704,12770,12771,12779,12797,13007,13053,13064,13066,13067,13090,13092,13121,13156,13158,13159,13160,13166,13173,13187,13191,13193,13198,13260,13282,13335,13342,13370,13374,13403,13408,13411,13476,13490,13497,13498,13501,13523,13596,13649,13673,13680,13685,13688,13776,13778,13785,13805,13820,13824,13827,13849,13908,13919,13938,13948,13950,13972,13973,13982,13983,13991,13994,13996,14014,14022,14034,14057,14113,14137,14144,14160,14165,14177,14191,14195,14220,14256,14293,14306,14324,14353,14369,14396,14405,14425,14429,14434,14442,14451,14474,14536,14544,14557,14560,14577,14578,14585,14623,14629,14652,14655,14662,14709,14736,14758,14778,14799,14844,14846,14849,14902,15017,15037,15045,15049,15067,15122,15173,15186,15189,15198,15239,15250,15256,15365,15373,15389,15489,15511,15544,15581,15582,15639,15647,15648,15670,15673,15708,15745,15875,16005,16016,16096,16148,16155,16158,16162,16172,16186,16205,16222,16232,16281,16290,16300,16340,16358,16363,16388,16406,16428,16433,16448,16471,16508,16538,16558,16614,16643,16653,16781,16784,16857,16866,16888,16899,16991,16996,17047,17127,17130,17202,17287,17334,17379,17403,17610,17708,17709,17711,17768,17795,17813,17834,17880,17908,17926,17995,18065,18074,18126,18147,18162,18238,18240,18357,18360,18475,18480,18550,18632,18701,18713,18736,18785,18828,18841,18885,18892,18947,19084,19150,19187,19255,19265,19316,19366,19405,19419,19489,19556,19585,19724,19803,19840,19844,19899,19905,19908,19913,19933,19994,20009,20065,20178,20309,20322,20337,20391,20468,20520,20542,20697,20737,20761,20770,20794,20829,20856,20857,20862,20943,21014,21283,21301,21334,21349,21413,21461,21494,21724,21755,21765,21972,22102,22215,22327,22345,22538,22597,22794,22796,22805,22820,22897,22908,22913,22949,23048,23049,23082,23172,23330,23367,23398,23479,23531,23570,23618,23631,23685,23706,23742,23988,24055,24066,24071,24113,24137,24264,24363,24438,24621,24662,24663,24664,24940,25113,25132,25166,25186,25189,25195,25209,25248,25350,25462,25636,25704,25719,26320,26352,26367,26486,26602,26618,26665,26673,26710,26815,27004,27022,27023,27322,27360,27404,27455,27581,27723,27845,27936,27983,27995,28053,28121,28165,28260,28353,28665,29015,29076,29122,29371,29461,29731,30128,30139,30141,30309,30890,31117,31163,31175,31203,31246,31306,31535,31582,31668,32222,32316,32823,32856,33106,33155,33217,33542,33644,33676,33693,34016,34043,34086,34101,34106,34152,34341,34417,34549,34563,34769,34806,35019,35056,35169,35219,35688,35696,35944,36593,36691,36739,36819,36825,37028,37056,37137,37165,37495,37718,37735,37786,37821,37834,37931,37964,38007,38031,38055,38073,38093,38223,38303,38317,38319,38322,38357,38365,38415,38570,38579,38745,38778,38843,38970,39037,39053,39141,39180,39210,39451,39513,39514,39541,39691,39781,39800,39895,39939,40001,40247,40264,40505,40688,40769,40794,40805,40807,40932,40963,41009,41154,41210,41382,41469,41479,41513,41515,41630,41730,41733,42057,42151,42586,42618,42888,42889,43074,43090,43347,43546,43593,43595,43630,43653,43923,43935,44009,44147,44490,44555,44562,44564,44594,44718,44857,44896,44990,45132,45145,45243,45324,45380,45649,45658,45767,46138,46195,46256,46415,46435,46729,46829,46838,46889,47088,47502,47607,47686,47816,47941,48034,48463,48988,49010,49013,49020,49022,49519,49520,49524,49951,49963,50035,50135,50359,50544,50546,50646,50647,50725,50848,51052,51540,51588,51820,51942,51955,51995,52032,52067,52449,53256,53862,54054,55123,55180,55301,55347,55465,55561,55567,55721,55831,56288,56715,57089,57119,57157,57214,57294,57431,57800,57825,57943,58051,58151,58224,58233,58431,58492,58680,59108,59436,59678,59860,59861,59930,59962,59968,60307,60422,61337,61752,62008,62177,62206,62213,62214,62764,62838,63020,63492,63574,64328,64559,64688,64807,65057,65759,66125,66195,66607,66942,67660,67911,67913,68179,68202,68684,70478,70829,70868,71552,71864,71880,72105,72113,72197,72207,72358,72359,72766,73247,73511,73532,73935,73937,74465,74510,74534,74643,75531,76489,76492,76493,76494,76706,76996,77174,77459,77875,77930,77931,77953,78149,78373,79587,79940,80035,80271,80304,80468,80585,81836,82532,82533,82650,82654,82679,82687,82690,82693,82696,82702,83666,84174,84184,84200,84204,84329,84332,84355,84659,85860,86838,87428,87567,87818,87826,88005,88042,88641,88751,89492,89857,89861,90414,91070,91122,92591,93456,95755,96238,96534,98369,98557,98566,99826,100042,100275,100975,103370,103903,106646,107811,107985,109414,109418,109431,109443,109451,109513,111794,113406,113947,114065,114150,116149,116741,116745,116977,117942,120467,121826,121986,122906,124459,125123,125537,126319,127867,129139,133698,133931,136400,136795,137093,137106,137347,138697,138832,139038,139715,139998,140300,140823,142132,144340,145220,146216,146239,146304,147767,147773,150540,152737,153795,157058,157386,158150,159824,160588,165864,166624,168027,168530,170480,170687,171274,172385,173224,173931,174311,175291,175528,175555,175574,177572,179144,180296,181330,181533,183894,184098,184345,187017,188161,188652,189711,192134,193610,193722,193893,194662,195589,196867,198062,198277,203801,206213,206296,208134,208869,209263,209403,210860,211672,211954,214756,215924,217708,218778,220488,222250,222899,222936,223702,224141,224569,225565,225886,226486,227159,227783,228161,228165,228326,228967,231576,231617,232672,239563,239573,239678,242083,243938,244403,244534,246403,248774,250349,252512,252680,253235,253306,254470,254472,255266,256092,256591,256924,256961,256962,257091,257211,257344,257445,258509,259694,260778,264999,266857,268171,268238,268920,270487,270946,271718,272693,274167,274479,278316,280391,281730,284296,286939,287903,290825,291270,291362,291805,291870,292483,293644,293660,294512,294600,296099,297621,300706,301748,302688,302699,304410,308531,308639,312793,315664,316002,317930,318846,319888,323675,323676,323967,324352,325133,329833,333348,340816,342521,347969,351819,355629,357441,361398,361505,362105,362765,367551,375950,376659,378200,385636,386826,426469]
        drama_ids = [13,14,16,19,20,25,28,38,55,59,65,66,69,70,71,73,76,78,79,80,83,98,103,104,111,116,117,137,141,142,146,153,155,162,167,173,177,182,186,197,203,205,207,219,223,226,227,231,235,238,240,242,243,245,248,251,254,257,261,272,274,278,279,284,289,297,309,311,322,327,334,338,342,345,346,350,380,387,388,389,392,398,400,401,403,404,409,421,423,424,436,451,453,454,455,462,464,468,470,473,480,489,492,497,503,504,507,508,509,510,522,524,526,535,539,542,546,547,549,550,568,573,577,581,582,586,587,590,592,593,594,595,597,598,606,612,613,615,616,617,619,627,629,634,639,640,641,642,644,650,652,654,664,666,670,686,687,688,702,703,711,712,713,745,746,769,770,773,783,786,787,788,792,795,796,801,802,805,811,819,820,821,824,826,838,840,844,857,859,866,868,873,874,881,887,905,907,913,921,925,935,947,978,979,985,987,990,1018,1024,1073,1088,1116,1123,1124,1125,1164,1165,1213,1245,1246,1248,1251,1255,1259,1262,1265,1266,1359,1360,1365,1366,1372,1378,1381,1382,1391,1402,1412,1415,1417,1422,1424,1427,1429,1435,1439,1440,1443,1491,1494,1495,1523,1538,1544,1546,1548,1550,1551,1555,1574,1578,1579,1585,1587,1590,1591,1619,1620,1640,1642,1645,1646,1651,1677,1696,1710,1717,1722,1725,1770,1788,1808,1809,1813,1817,1830,1833,1844,1850,1852,1874,1878,1883,1885,1887,1900,1901,1903,1904,1907,1909,1913,1921,1927,1931,1933,1947,1949,1950,1951,1955,1956,1957,1966,1985,1988,1989,1997,1999,2001,2008,2009,2011,2013,2024,2026,2034,2044,2054,2056,2057,2088,2100,2110,2112,2116,2118,2133,2142,2148,2163,2176,2196,2211,2251,2253,2255,2266,2275,2280,2288,2289,2290,2300,2312,2320,2355,2370,2428,2447,2501,2502,2503,2567,2575,2577,2604,2610,2621,2637,2639,2649,2652,2655,2669,2675,2755,2757,2771,2786,2841,2895,2900,2977,3033,3059,3060,3082,3083,3116,3131,3170,3175,3291,3472,3482,3536,3558,3580,3594,3635,3682,3683,3766,3877,3902,4012,4032,4107,4133,4147,4148,4170,4174,4251,4347,4348,4349,4380,4421,4464,4474,4476,4477,4512,4515,4517,4518,4547,4550,4553,4566,4584,4597,4599,4614,4657,4688,4723,4816,4836,4911,4912,4922,4942,4944,4951,4953,4958,4959,4960,4964,4982,4995,4997,5038,5123,5125,5126,5172,5178,5279,5353,5528,5689,5708,5722,5723,5759,5822,5852,5900,5902,5915,5925,5955,5971,5994,6007,6016,6023,6071,6106,6116,6171,6217,6435,6440,6478,6479,6520,6521,6537,6538,6615,6639,6947,6950,6963,6964,6968,6972,6973,6977,7006,7214,7220,7301,7303,7304,7305,7326,7345,7347,7350,7364,7445,7461,7485,7504,7509,7510,7515,7547,7548,7735,7859,7863,7870,7873,7874,7913,7973,7978,7979,7980,8007,8046,8051,8053,8055,8060,8065,8090,8095,8197,8198,8271,8272,8291,8293,8321,8326,8328,8338,8346,8358,8359,8409,8416,8435,8456,8470,8488,8489,8545,8587,8618,8643,8649,8656,8665,8669,8741,8744,8818,8834,8836,8838,8841,8842,8848,8883,8885,8913,8942,8944,8952,8963,8966,8967,8968,8975,8981,8982,8984,8988,8998,8999,9008,9009,9026,9030,9032,9034,9036,9043,9045,9075,9087,9089,9093,9095,9100,9104,9208,9268,9275,9277,9281,9282,9289,9291,9294,9302,9303,9310,9311,9313,9315,9331,9339,9344,9361,9366,9372,9388,9390,9400,9422,9428,9433,9437,9440,9441,9443,9447,9452,9454,9464,9466,9469,9476,9481,9504,9509,9515,9516,9517,9526,9549,9550,9552,9555,9563,9566,9567,9571,9573,9583,9587,9588,9591,9594,9598,9603,9613,9615,9616,9621,9623,9625,9631,9647,9655,9662,9664,9667,9672,9675,9676,9683,9685,9686,9689,9693,9697,9700,9701,9702,9709,9713,9715,9726,9729,9741,9746,9762,9763,9766,9770,9779,9782,9787,9798,9800,9813,9816,9819,9821,9829,9833,9837,9839,9842,9849,9869,9870,9879,9882,9884,9894,9895,9903,9912,9913,9916,9918,9922,9930,9944,9945,9950,9952,9955,9962,9963,9989,9991,10013,10022,10024,10025,10030,10047,10052,10060,10065,10068,10075,10105,10115,10117,10132,10139,10147,10183,10184,10185,10187,10188,10197,10200,10207,10215,10217,10219,10220,10223,10229,10238,10253,10269,10279,10288,10312,10316,10317,10320,10329,10333,10339,10357,10362,10364,10368,10377,10385,10388,10390,10391,10397,10398,10400,10413,10416,10425,10428,10436,10437,10445,10461,10468,10472,10476,10478,10523,10530,10533,10534,10537,10545,10549,10559,10560,10564,10571,10589,10592,10611,10623,10629,10632,10637,10641,10642,10647,10655,10673,10683,10684,10691,10696,10705,10707,10712,10731,10734,10740,10741,10744,10773,10774,10782,10786,10802,10822,10844,10858,10866,10873,10876,10894,10913,10914,10930,10934,10935,10947,10950,10956,10994,10998,11004,11013,11022,11023,11027,11036,11042,11051,11058,11062,11065,11086,11091,11093,11109,11113,11128,11129,11130,11152,11156,11162,11165,11170,11184,11186,11190,11191,11202,11208,11229,11240,11249,11257,11298,11306,11308,11313,11321,11322,11323,11324,11354,11358,11362,11370,11386,11395,11400,11404,11426,11431,11446,11457,11458,11468,11478,11495,11499,11509,11536,11545,11560,11564,11583,11600,11615,11620,11632,11644,11658,11661,11679,11699,11702,11778,11798,11804,11818,11820,11826,11831,11835,11866,11873,11876,11887,11889,11892,11904,11934,11935,11967,11969,11971,11973,11975,11978,11979,11983,12079,12093,12100,12109,12113,12117,12123,12149,12150,12154,12159,12160,12162,12163,12183,12184,12193,12201,12220,12227,12247,12257,12271,12281,12289,12400,12404,12405,12410,12412,12454,12498,12506,12508,12509,12555,12573,12586,12596,12612,12618,12637,12690,12703,12770,12783,12838,12877,12920,13067,13072,13074,13075,13079,13090,13092,13132,13150,13156,13159,13193,13197,13198,13201,13223,13250,13279,13363,13374,13389,13405,13429,13435,13490,13491,13497,13501,13518,13536,13537,13551,13569,13579,13649,13685,13688,13689,13751,13768,13776,13811,13816,13853,13856,13888,13889,13898,13919,13920,13937,13960,13967,13972,13973,13990,13996,14012,14024,14047,14054,14057,14112,14114,14120,14181,14202,14256,14283,14290,14292,14293,14295,14299,14325,14337,14351,14359,14392,14395,14429,14438,14462,14474,14538,14544,14574,14578,14582,14585,14608,14624,14629,14631,14635,14652,14662,14709,14736,14745,14757,14758,14778,14799,14811,14823,14834,14846,14849,14854,14877,14902,14914,14976,15005,15013,15037,15045,15059,15070,15074,15121,15186,15198,15208,15237,15250,15256,15301,15389,15394,15487,15556,15568,15624,15644,15648,15660,15670,15699,15708,15765,15907,15927,15976,15992,16005,16052,16072,16110,16158,16161,16162,16186,16222,16232,16241,16323,16351,16358,16388,16433,16564,16608,16619,16620,16633,16642,16643,16651,16653,16727,16769,16781,16857,16858,16869,16988,16991,17044,17113,17127,17130,17134,17139,17170,17182,17186,17187,17202,17277,17332,17345,17379,17403,17431,17436,17663,17707,17734,17795,17880,17908,17917,17979,18041,18074,18079,18126,18191,18206,18239,18240,18254,18276,18292,18320,18405,18475,18487,18516,18530,18533,18602,18615,18681,18701,18712,18734,18777,18808,18828,18840,18869,18886,18900,18923,18925,18937,18947,19052,19255,19344,19457,19615,19644,19844,19848,19913,19997,20024,20055,20065,20083,20156,20322,20360,20391,20406,20520,20533,20616,20697,20737,20761,20763,20764,20766,20829,20862,21074,21301,21309,21311,21334,21345,21349,21355,21413,21461,21494,21612,21641,21755,21801,21972,22013,22051,22215,22256,22267,22301,22314,22327,22479,22488,22556,22597,22600,22617,22649,22796,22798,22803,22805,22881,22907,22908,22913,22947,22954,22971,22972,23168,23169,23367,23655,23759,24021,24034,24055,24071,24137,24206,24226,24266,24356,24363,24420,24424,24469,24575,24663,24664,24684,24747,24748,24803,24973,24985,25113,25189,25196,25208,25212,25248,25312,25350,25376,25379,25388,25428,25461,25520,25636,25643,25678,25769,25784,25786,25793,25941,25968,26022,26039,26171,26268,26306,26320,26367,26371,26379,26388,26390,26428,26518,26602,26618,26665,26748,26791,26815,26837,26899,26916,27022,27029,27191,27322,27329,27451,27455,27569,27579,27585,27586,27588,27759,27845,27983,28005,28029,28053,28089,28178,28211,28580,28665,28666,28902,28932,29078,29146,29193,29262,29339,29371,29406,29461,29463,29697,29912,29920,29963,29996,30082,30128,30246,30309,30596,30890,30943,30973,31005,31007,31064,31166,31174,31175,31306,31582,31640,31668,31908,32222,32235,32274,32395,32456,32579,33106,33157,33196,33430,33511,33644,33667,33693,33870,33909,34099,34152,34335,34584,34647,34653,34697,34723,34769,34941,35219,35690,35691,35696,36046,36334,36351,36419,36549,36584,36597,36691,36739,36811,37028,37056,37080,37165,37206,37232,37233,37414,37495,37532,37694,37737,37786,37799,37842,37903,37950,37958,38031,38073,38093,38117,38167,38223,38357,38358,38363,38415,38428,38448,38717,38780,38810,38970,39013,39053,39055,39141,39210,39254,39269,39349,39437,39486,39538,39541,39563,39780,39781,39800,39806,39833,39845,39851,40001,40185,40247,40494,40652,40769,40794,40807,40880,40920,41009,41110,41144,41210,41233,41248,41283,41317,41402,41469,41479,41488,41508,41730,41733,41823,41830,41894,42109,42151,42188,42222,42297,42345,42497,42586,42618,42807,42819,42888,43090,43266,43306,43347,43418,43434,43539,43610,43743,43839,43867,43884,43923,43931,43933,43949,43959,44009,44113,44115,44214,44264,44413,44490,44555,44564,44594,44603,44634,44638,44718,44754,44770,44826,44835,44853,44857,44865,44944,44945,45054,45132,45138,45153,45269,45272,45317,45324,45649,45658,45767,45791,45881,45958,46138,46252,46332,46435,46503,46705,46727,46729,46738,46829,46849,46889,46989,47452,47502,47534,47607,47692,47889,48034,48035,48171,48217,48231,48289,48309,48620,49017,49020,49022,49026,49047,49081,49471,49517,49787,49950,49963,50014,50035,50348,50497,50601,50620,50646,50725,50780,50837,50839,50848,50875,51052,51384,51828,51942,51995,52015,52032,52462,52790,53113,53256,53457,54580,54897,55123,55180,55306,55347,55420,55561,55604,55720,55787,55831,55903,56491,56601,56666,56930,57022,57120,57157,57212,57294,57825,57943,58051,58595,58882,59440,59728,59861,59930,59968,60243,60308,60309,60400,60420,60421,60422,60599,61038,61337,61791,61891,62008,62116,62204,62215,62255,62402,62630,62676,62677,62728,62764,62835,62837,63006,63020,63287,64499,64639,64678,64682,64685,64686,64690,64720,65057,65086,65203,65448,65749,65754,66025,66125,66468,66767,66942,67373,68412,68718,68722,68724,68727,68734,68812,68924,69640,69668,69848,70006,70687,71157,71688,71859,71864,71866,72113,72190,72213,72358,72431,72570,72913,72976,73511,73532,73567,73873,74457,74465,74534,74536,74643,75033,75174,75531,75780,75861,75900,75986,76025,76203,76349,76494,76649,76726,76758,77016,77332,77866,77877,77930,77934,77987,78307,78373,78698,78705,78814,79120,79587,79777,80271,80278,80585,81220,82525,82532,82631,82682,82684,82693,82695,82696,83542,83588,83666,83686,83770,83860,84175,84184,84188,84197,84329,84332,84355,84659,84892,85350,85446,86331,86549,86812,86825,86829,86834,86837,87093,87499,87502,87729,87825,87827,88005,88036,88641,88794,89325,89540,89708,90369,91076,91721,92591,94072,96399,96534,96721,96724,97367,97370,97614,97630,98357,98369,99826,100975,101173,102362,103328,103370,103663,103731,104896,106646,108346,109091,109410,109417,109421,109424,109491,109729,110402,110415,110683,111190,112430,112456,113406,113464,113947,115872,116584,116613,116745,117251,118452,119450,119657,120467,121826,121986,122081,122906,123553,124606,125052,125263,126319,127493,127560,129670,130150,132316,132344,132363,133575,133694,133805,134371,134411,135595,136797,137094,137321,137347,138697,138976,139998,140823,144336,144340,146233,146238,146269,146882,147441,147773,150202,150540,150689,152532,152599,152601,152737,152742,152747,152760,153397,153795,157293,157336,157353,157354,157386,157841,157847,157909,158895,159037,159770,160588,161795,162903,164457,166624,167073,168672,169917,171274,172533,174311,174751,175291,175541,175555,176124,179144,182291,182873,183894,184341,184374,185465,185567,186935,190955,191714,192102,192132,192134,192136,192210,193722,193756,194662,196867,198185,198277,199933,200505,201088,201132,203833,205220,205587,205596,205775,206197,206284,206296,206563,208869,209263,209274,209451,210577,211086,211954,215211,215918,215924,216015,217708,222649,222935,222936,225235,226354,226857,227156,227306,227735,227975,228066,228150,228194,228203,228205,228970,230266,231576,231617,232679,235260,235271,236751,239566,239571,239678,241239,241554,241771,242083,242575,242582,244267,244403,244534,244772,244776,244783,244786,245700,245703,245846,245916,248402,249164,250124,250184,251321,251979,252360,252512,253235,253253,253331,253412,253450,253626,254024,254128,254473,256591,256687,256740,256917,256924,256962,258755,259943,261023,263503,264644,264656,264660,264999,265208,266034,266102,266396,266856,268238,269057,270487,270554,271185,271331,271969,272878,273248,273481,273895,273899,274479,277216,278927,280092,280871,281230,281730,281957,283708,284293,284296,284536,285783,286217,286565,287625,288927,288980,289180,290595,290751,291081,291270,293646,293863,294086,294600,295886,295914,295964,296096,296098,297596,299145,300168,300671,300673,301325,301351,302579,304357,304410,306667,306745,307081,308467,308529,308639,309425,309503,309919,310569,310706,312113,312221,314365,314385,315011,315664,316152,318040,318846,318850,319888,319910,320146,321697,321741,322443,323677,323967,324352,325373,325789,326576,327833,330770,331190,331592,332411,332567,333371,334527,334531,339408,339984,340611,343795,344466,345003,347126,347764,351043,354110,354624,355629,356987,357837,358451,360339,361398,361475,361505,364083,365222,366967,370980,373314,374461,375290,375950,376004,378237,385383,385636,394047,395766,407887,408429,426469,433715]
        fam_ids = [12,35,105,118,129,165,196,252,257,332,408,411,425,433,533,585,601,630,671,672,673,674,675,756,767,771,772,788,808,809,810,812,850,862,863,879,888,889,920,926,950,953,1088,1265,1268,1273,1497,1499,1585,1593,1649,1667,1788,1997,2054,2062,2157,2270,2280,2300,2309,2395,2454,2486,2493,2661,2698,2976,3050,3170,3587,4032,4244,4523,5255,5393,5559,6477,6795,7443,7450,7453,7459,7484,7518,8204,8326,8355,8359,8587,8839,8871,8916,8920,8981,9016,9021,9023,9036,9099,9279,9297,9310,9353,9408,9444,9447,9449,9487,9488,9502,9513,9570,9574,9593,9598,9607,9655,9806,9816,9822,9837,9849,9880,9893,9906,9907,9928,9969,9975,9978,9981,9982,9986,9992,10022,10025,10028,10054,10067,10137,10140,10188,10191,10192,10193,10196,10198,10199,10202,10208,10214,10315,10386,10414,10437,10439,10472,10481,10488,10501,10527,10530,10545,10555,10567,10588,10603,10642,10674,10681,10708,10715,10719,10748,10756,10800,10808,10865,10895,10947,10982,10985,10991,10992,10996,11011,11113,11130,11176,11212,11260,11283,11359,11395,11451,11459,11544,11619,11637,11688,11802,11836,11870,11887,11888,11904,12096,12144,12154,12155,12227,12279,12429,12589,12610,12819,12920,13053,13155,13156,13187,13374,13579,13600,13649,13673,13680,13682,13688,13700,13768,13824,13836,13908,13967,14043,14113,14144,14160,14165,14175,14191,14199,14306,14317,14358,14405,14411,14429,14442,14444,14544,14560,14623,14624,14635,14836,14873,15028,15045,15121,15173,15189,15487,15489,15511,15512,15582,15648,15655,15699,15907,16110,16112,16340,16508,16523,16577,16651,16653,16690,16866,17043,17130,17264,17345,17644,17663,17709,17710,17711,17834,17880,17908,17917,18126,18147,18276,18357,18360,18736,18840,18885,18937,18975,19084,19405,19585,19933,20352,20455,20483,20542,20653,20694,20737,20856,21334,21765,21972,22102,22345,22488,22794,22796,22949,23069,23172,23367,23398,23479,24034,24100,24266,24432,24662,24961,25132,25353,25379,25786,26379,26672,26963,27983,28178,29339,31117,32657,33217,34043,34086,34099,34549,34584,34723,35690,35691,36355,36696,36819,36825,36970,37206,38055,38223,38317,38579,38757,38843,39055,39180,39541,39691,40688,41216,41513,41515,44826,44896,45767,46195,46256,49013,49444,49478,49519,49852,49948,49953,50135,50321,50359,51052,51162,54518,55301,55567,56288,56601,57089,57800,58224,59981,60307,60400,61038,62177,62211,62214,62764,62837,64328,65759,66125,67675,68179,68728,71805,71864,72197,73191,73247,74465,76285,76492,76706,77174,77459,77931,77934,77950,77951,78373,80321,81005,81188,82650,82690,82702,82703,84659,88751,93456,94352,102651,104896,105864,109445,109451,112937,116149,116711,116977,126319,133931,137106,140300,145220,150540,150689,153518,157841,158852,159824,170480,170687,171759,172385,172391,173931,175574,177572,181533,196867,202575,211672,218778,226354,227707,227735,227783,228161,228165,228326,238603,246449,256961,257932,258509,266647,267935,268171,270946,272726,272878,278927,283671,292481,294272,294512,302688,306667,328111,333348,357441,361475,371690,379532,417859,426469,447027]
        history_ids = [79,117,197,205,279,387,424,522,549,612,613,616,642,676,746,783,820,821,826,855,857,874,887,921,947,978,1116,1439,1495,1722,1779,1852,1874,1883,1887,1904,1934,1955,1966,2024,2211,2253,2290,2428,2447,2669,3131,3291,3683,4107,4464,4515,4517,4518,5769,5902,5925,6538,6968,6973,8095,8665,8741,8818,8883,9026,9045,9289,9361,9443,9459,9549,9555,9664,9829,10047,10105,10139,10410,10523,10533,10590,10655,10705,10733,10741,10858,10935,11156,11165,11202,11322,11400,11499,11620,11658,11661,11831,11969,12100,12228,12246,12602,12783,13537,13922,14048,14292,14299,14392,14538,14582,14729,14877,14902,15927,16005,16072,16564,17139,17277,18254,18320,18712,18840,19495,19644,21345,22301,22954,24973,26428,26843,27329,27759,28005,28089,29996,30596,30973,31668,31908,33157,38428,38543,42345,43418,43434,44092,44865,45269,46138,46332,58882,60309,61891,69848,71688,72431,72913,72976,76203,76349,76649,76758,88794,96399,97630,98549,113464,127560,140823,152532,152760,159037,184374,192136,205596,205775,245700,253450,256040,273895,280871,281230,293646,300671,300673,314365,316152,319069,319888,321697,358451,365222,375290,407887]
        horror_ids = [170,176,214,215,326,348,377,440,539,578,579,588,609,622,628,663,679,692,694,747,755,764,765,766,768,790,794,805,837,924,927,928,948,985,1091,1250,1255,1547,1551,1562,1576,1577,1683,1690,1691,1696,1698,1813,1933,1946,1961,1970,1975,2637,2655,2662,2667,2907,3021,3028,3597,3600,4232,4233,4234,4513,4970,5072,5759,5876,6114,6171,6217,6466,6479,6488,6537,6552,6933,7006,7341,7737,7978,8077,8078,8329,8337,8408,8413,8461,8617,8643,8814,8843,8869,8875,8913,8922,8968,9003,9009,9022,9030,9035,9042,9059,9092,9095,9100,9276,9286,9306,9348,9357,9358,9360,9362,9378,9392,9424,9457,9532,9533,9544,9552,9616,9645,9656,9682,9707,9725,9728,9730,9731,9783,9792,9793,9825,9877,9902,9913,9945,9946,9954,10008,10012,10014,10016,10017,10053,10065,10066,10069,10070,10072,10075,10092,10131,10160,10163,10185,10212,10225,10226,10253,10280,10281,10283,10285,10288,10306,10307,10320,10331,10336,10383,10384,10391,10496,10577,10585,10643,10664,10676,10727,10776,10781,10873,10885,10894,10925,10929,10972,10984,10987,11015,11026,11033,11056,11058,11096,11152,11186,11217,11237,11249,11284,11298,11336,11342,11351,11357,11361,11377,11442,11460,11470,11495,11507,11531,11564,11586,11592,11596,11601,11618,11683,11804,11908,11917,11932,11954,11979,11980,12142,12158,12192,12212,12484,12602,13006,13025,13121,13429,13510,13515,13569,13788,13812,13849,13937,14033,14353,14435,14451,14745,15158,15239,15301,16028,16205,16241,16281,16288,16337,16871,17287,17577,17994,18045,18238,18405,18442,18616,18841,19204,19898,19901,19904,19908,19912,19994,20981,21208,22007,22530,22804,22894,22970,23730,23827,23963,23988,24100,24126,24150,24913,25066,25769,25983,26466,26688,27374,27420,27588,28165,28260,28355,29064,29426,29427,29514,30315,30497,31915,33468,34335,34592,35073,35791,36095,36419,36586,36647,36648,37707,38033,38321,38358,39303,39563,39895,40264,41402,41436,41439,41446,43593,43931,43935,43947,44040,45649,46146,46261,46420,46838,48171,48309,48463,48572,49017,49018,49365,49730,49787,49950,50037,50357,50497,50538,50698,50942,52015,52520,53502,53953,54702,55616,55779,57876,58151,58428,58431,60304,61012,65055,65086,68684,69270,71469,71679,72086,72190,72331,72571,73935,74725,74777,76487,76617,77156,77883,77949,78381,78383,79316,79694,80468,82505,82507,82654,82990,84178,84204,86825,91586,92182,92635,93856,100241,100275,101179,103620,104755,106845,107315,109428,114635,115210,117942,118957,125490,132232,133805,134597,138843,139038,139715,146203,150202,150211,157185,157422,157544,157547,158015,158752,165864,168705,171424,184345,184346,189711,190847,193603,202604,205321,207769,211557,220490,226458,227348,228550,234212,238636,241257,242512,243940,244316,246403,250184,250546,253306,254472,256274,257087,257445,259693,270303,277685,280092,280381,283445,283686,285743,285923,286939,287424,287524,287903,290391,290555,290825,293670,298312,298584,299245,301325,301365,308467,309919,310131,310933,312791,313922,315011,316727,321258,323270,323271,325123,329440,330770,332285,332567,335866,345911,347548,347755,347764,351043,356483,361159,362105,386826,396152,402515,426067]
        mystery_ids = [62,77,141,152,176,180,182,186,223,251,297,320,322,345,431,473,512,573,588,591,592,593,617,622,670,675,686,745,768,782,805,807,837,846,979,1018,1073,1090,1091,1124,1424,1586,1642,1685,1813,1844,1903,1933,1949,1956,1958,1970,1985,2026,2043,2044,2057,2059,2118,2252,2275,2370,2501,2503,2637,2649,2655,2666,2667,2675,2779,2832,3049,3093,3489,3580,3594,3597,3600,3766,4174,4232,4233,4234,4566,4657,4922,4997,5137,5236,5279,5503,5780,5955,6687,6933,6947,6973,7364,7485,8053,8054,8197,8224,8271,8329,8338,8413,8688,8834,8836,8968,8984,9022,9268,9276,9286,9311,9315,9358,9424,9437,9455,9481,9504,9548,9566,9573,9613,9616,9620,9631,9637,9645,9667,9697,9707,9729,9913,9944,9946,9963,10133,10185,10225,10226,10329,10388,10398,10528,10676,10684,10685,10731,10740,10756,10782,10866,10871,10885,10944,10956,10972,11015,11024,11026,11033,11096,11190,11208,11219,11313,11324,11377,11412,11439,11456,11468,11507,11531,11560,11588,11596,11601,11618,11644,11679,11831,11863,11904,12096,12117,12150,12201,12245,12403,12602,13027,13079,13183,13197,13448,13483,13515,13536,13551,13788,13811,14033,14043,14283,14359,14435,14462,15992,16148,16617,17578,18041,18615,18681,18777,19898,19904,19912,20055,20156,21208,22787,22804,22824,23827,23963,24913,25166,25208,25212,25376,25428,25983,26268,26388,26688,26748,26791,27205,27576,28211,28355,29193,29427,29917,30141,30943,34069,34813,35219,35689,36095,36419,36549,37233,37686,37903,39303,39939,41402,41446,43743,43931,43935,44040,44718,45612,45649,46503,46738,47890,48138,49517,50538,51130,55779,58574,59965,61012,65754,68727,69640,69668,70436,70981,74777,75612,82507,86812,92182,94348,98568,101179,118612,123553,134371,137321,152742,157353,158852,169917,171274,181940,198663,199933,201088,202604,204922,206197,208763,210577,225574,238615,241257,241554,241766,245916,252512,260947,270487,271185,273248,273481,286565,290751,291081,291805,293670,301325,309919,310131,319910,321258,322194,328387,328425,330770,343409,347764,351043,362765]
        romance_ids = [13,20,38,69,76,80,114,116,137,142,146,162,182,184,194,219,239,243,245,251,261,284,289,319,321,338,350,392,401,409,451,453,454,455,464,468,480,508,509,526,535,542,544,547,597,619,621,628,634,639,676,688,693,703,712,713,744,770,782,795,796,802,812,824,844,854,859,872,887,889,905,907,913,921,987,1245,1259,1262,1360,1365,1378,1381,1389,1391,1439,1440,1443,1491,1544,1555,1581,1587,1597,1599,1636,1651,1722,1788,1809,1819,1824,1833,1844,1850,1901,1903,1904,1907,1909,1921,1934,1950,1966,1989,2008,2022,2044,2057,2074,2105,2148,2211,2255,2266,2270,2280,2288,2293,2493,2577,2610,2619,2621,2642,2752,2770,2779,2830,2898,2976,2977,3060,3062,3078,3080,3172,3175,3635,3933,3981,4148,4251,4347,4348,4379,4380,4476,4517,4523,4584,4599,4688,4806,4912,4922,4942,4951,4964,5038,5178,5689,5723,5769,5822,5852,5966,5994,6023,6068,6073,6114,6440,6520,6557,6615,6639,6957,6961,6964,7301,7303,7326,7509,7515,7547,7548,7870,7942,7973,8051,8055,8060,8095,8141,8198,8273,8291,8293,8328,8346,8390,8488,8656,8676,8842,8874,8879,8952,8966,8984,8998,9007,9026,9027,9029,9043,9087,9089,9093,9095,9280,9281,9294,9302,9303,9327,9339,9361,9390,9434,9441,9454,9464,9476,9489,9541,9543,9550,9576,9582,9583,9587,9588,9603,9616,9621,9655,9664,9675,9678,9683,9686,9700,9709,9715,9716,9726,9762,9767,9778,9794,9801,9816,9833,9839,9842,9870,9880,9889,9895,9919,9930,9962,9981,10003,10013,10017,10025,10028,10030,10050,10068,10075,10096,10154,10162,10184,10197,10198,10202,10207,10215,10218,10219,10229,10269,10279,10288,10314,10333,10362,10390,10416,10436,10445,10472,10478,10533,10563,10564,10571,10603,10641,10642,10646,10647,10691,10696,10705,10712,10739,10744,10761,10783,10786,10803,10806,10808,10833,10878,10894,10913,10934,10956,10998,11013,11027,11036,11065,11066,11086,11091,11113,11130,11137,11141,11153,11162,11172,11191,11208,11232,11240,11257,11363,11386,11400,11426,11431,11451,11452,11467,11529,11536,11561,11620,11622,11631,11632,11637,11638,11648,11661,11775,11812,11820,11823,11863,11876,11887,11889,11971,11983,12107,12158,12159,12163,12177,12182,12183,12193,12220,12257,12404,12405,12509,12586,12618,12620,12637,12657,12658,12771,12779,12783,12797,13066,13067,13092,13132,13159,13198,13201,13435,13476,13491,13497,13501,13523,13539,13596,13689,13768,13888,13967,13972,13994,14024,14054,14057,14156,14165,14177,14191,14202,14283,14295,14324,14395,14429,14434,14474,14578,14582,14608,14624,14629,14709,14736,14758,14811,14834,14844,14846,14854,14877,15017,15037,15121,15122,15173,15186,15256,15556,15624,15648,15708,15875,15976,16158,16161,16186,16222,16300,16323,16388,16428,16558,16633,16642,16643,16653,16781,16899,17044,17127,17130,17186,17187,17334,17403,17709,17813,17820,17926,18126,18206,18239,18240,18320,18615,18701,18828,18840,18923,18937,19255,19265,19316,19344,19556,19840,19844,19899,19913,20009,20065,20178,20309,20322,20360,20857,20943,21283,21311,21349,21355,21413,21461,21494,21755,22051,22215,22267,22327,22556,22597,22649,22897,22913,22947,22971,23049,23069,23082,23169,23531,23570,23655,24021,24055,24071,24113,24137,24266,24420,24621,24663,24684,24803,24940,24985,25113,25189,25195,25196,25209,25312,25376,25461,25462,25520,25636,25643,25719,25968,26022,26306,26371,26602,26673,26748,26815,27191,27322,27588,27686,27995,28005,28029,28121,28260,28353,28665,29076,29146,29371,29463,29731,29963,29996,30082,30139,31005,31163,31246,32222,32456,32856,33430,33644,33667,33870,34016,34043,34106,34653,34806,35032,35688,35690,36046,36691,36811,37056,37080,37710,37737,37786,37821,37842,37964,38007,38031,38050,38073,38093,38117,38303,38317,38357,38415,38448,38543,38665,38970,39037,39053,39141,39451,39563,39780,39833,40001,40185,40652,40794,41110,41210,41233,41248,41317,41469,41630,41823,42057,42109,42188,42297,42497,42586,42618,42888,43306,43347,43539,43839,43867,43949,44594,44770,44853,44857,44990,45145,45272,45658,45881,46415,46503,46705,46727,46729,46889,47452,47607,47816,47889,48217,49020,49022,49963,50035,50544,50546,50620,50646,50725,50848,51384,51828,51955,53113,53256,53862,55347,55604,55721,55787,55831,56666,56930,57825,57943,58051,58431,58680,59436,59457,59860,59861,59930,59962,60420,62008,62838,63020,63492,64678,64682,65203,65749,66942,67660,68202,70868,71547,72570,72710,72766,73247,73935,74084,74643,76494,76649,76996,77332,77875,77877,78698,79120,79698,79777,80271,80585,81836,82533,82654,82693,82695,82696,83666,84174,84184,84332,84892,85446,86331,86837,87729,87825,88005,89325,90369,90414,91122,96238,96534,96724,98557,102651,108346,109491,109513,111794,112949,113947,114150,121676,121826,123553,125052,125123,125537,129139,132316,132344,133575,133698,137321,138697,144340,150689,152599,152601,152742,153158,153397,157386,158150,161795,167073,171274,172533,173224,183894,184098,185008,191714,193610,198277,206296,209263,215211,216015,217708,220488,222899,222935,222936,223485,225565,226857,228205,228326,231617,239571,241771,248774,250124,251979,253235,255266,255343,256591,258755,259694,260778,266856,268171,272693,278316,286565,291270,293863,296096,297621,301351,302688,306745,314385,316002,318040,324352,325373,340816,351819,357837,358451,361475,361505,378200,380733]
        scifi_ids = [11,18,19,38,62,68,74,75,78,95,105,106,149,152,154,157,165,167,168,169,170,172,173,174,180,193,196,199,200,201,218,280,296,329,330,331,348,395,431,435,440,534,563,593,601,602,603,604,605,607,608,644,679,686,698,754,782,811,816,817,818,834,837,840,841,844,846,860,861,865,869,889,926,957,985,1090,1091,1103,1255,1272,1381,1452,1487,1497,1499,1551,1562,1576,1577,1635,1648,1649,1685,1687,1688,1705,1724,1726,1771,1858,1891,1892,1893,1894,1895,1903,1924,1927,1946,1954,2048,2067,2080,2114,2135,2157,2277,2577,2661,2666,2675,2687,2756,2787,2789,2900,3028,3034,3509,3604,4474,4723,4858,4965,5137,5172,5393,5491,5550,5876,6171,6479,6795,6950,7191,7299,7341,7450,7453,7459,7512,7737,8011,8069,8077,8078,8202,8247,8285,8337,8338,8373,8408,8413,8452,8487,8536,8645,8698,8810,8831,8836,8843,8850,8854,8870,8914,8953,9016,9035,9067,9271,9276,9294,9304,9306,9327,9341,9348,9355,9381,9383,9389,9424,9425,9457,9531,9562,9570,9574,9620,9659,9693,9741,9823,9824,9825,9849,9890,9920,9928,9954,10003,10016,10017,10045,10061,10077,10133,10138,10153,10163,10179,10200,10208,10253,10329,10336,10350,10357,10366,10384,10386,10416,10483,10514,10559,10643,10658,10676,10724,10748,10771,10796,10803,10865,10981,11058,11232,11237,11253,11260,11336,11411,11470,11535,11551,11561,11588,11687,11692,11827,11918,11935,11954,12088,12107,12120,12123,12211,12244,12279,12437,12589,13001,13006,13025,13183,13282,13363,13460,13475,13688,13768,13811,13812,13820,13836,13856,14139,14161,14164,14199,14337,14353,14623,14869,15028,15158,15239,15268,15301,15511,15512,16016,16110,16241,16300,16320,16577,16633,16866,16911,17431,17577,17654,18045,18162,18442,18501,18841,19405,19898,19901,19959,19995,20455,20504,20526,20542,20764,20856,21512,21765,22345,22824,22825,23048,23730,23963,24126,24264,24428,24746,25763,25769,26672,27205,27380,27549,28260,29146,29426,30315,30379,31867,31909,31915,32235,32740,33155,33468,34069,34086,34549,34851,35073,35791,36549,36648,36657,36658,36668,36819,37686,37707,38050,38055,38321,38356,38541,39254,39513,39538,40160,41154,42033,42188,42684,43630,43933,43935,44833,44912,44943,45612,45767,46529,46729,47933,49047,49049,49521,49529,49530,49538,50037,50357,50942,51955,52010,52015,53502,54138,55420,56715,57876,59457,59678,59967,61791,61984,62215,62764,68179,68684,68721,68724,68726,70160,70687,70981,71469,71679,72190,72545,72559,72710,75612,76170,76341,76726,76757,77156,79698,80274,81796,82700,83542,84204,84329,84332,86304,86812,87101,87421,88005,88751,91314,97020,97370,98566,98568,99861,100402,101299,102899,106845,107985,110402,110415,118340,119450,122906,125490,127585,131631,131634,134371,135397,137113,146631,152601,157336,157350,157353,158015,158852,166424,188927,190847,192577,198184,198663,199933,205126,206213,211557,218043,227156,227719,228066,228161,238603,238615,240832,242095,244267,245703,246655,257344,262500,262504,262543,264660,269057,270554,271110,286217,289180,290370,297761,299687,312793,315011,320146,326576,331592,333355,333371,335866,347548,360188,367551,371690]
        thriller_ids = [18,55,59,66,74,77,78,83,95,104,106,107,111,116,117,154,155,157,161,163,169,170,172,174,179,180,182,186,187,189,193,199,200,201,214,218,231,242,251,253,274,277,280,296,298,302,319,320,322,326,327,331,348,388,393,431,435,436,440,470,473,479,500,503,507,534,539,562,563,573,577,578,579,580,582,584,591,597,604,605,612,619,622,629,646,657,658,660,663,667,668,670,679,680,681,682,691,694,698,699,700,707,708,709,710,714,745,752,754,755,768,782,787,794,796,807,819,820,834,846,860,869,905,943,944,948,954,955,956,979,1018,1051,1073,1090,1123,1124,1213,1248,1250,1266,1272,1359,1368,1369,1370,1372,1422,1424,1491,1535,1537,1538,1551,1562,1571,1572,1573,1579,1586,1598,1613,1619,1620,1635,1639,1642,1645,1669,1698,1701,1710,1717,1770,1813,1817,1830,1852,1880,1900,1903,1907,1933,1946,1948,1949,1954,1957,1958,1970,1975,1979,1985,1988,1995,1996,1999,2001,2008,2026,2034,2043,2057,2059,2080,2084,2085,2088,2100,2112,2114,2116,2118,2122,2140,2155,2162,2163,2176,2185,2207,2251,2252,2253,2275,2320,2370,2453,2501,2502,2503,2575,2577,2636,2649,2652,2655,2675,2749,2756,2779,2786,2787,2832,2900,2989,3021,3040,3093,3132,3472,3482,3489,3509,3512,3536,3594,3595,3597,3600,4105,4108,4147,4170,4174,4327,4349,4442,4477,4513,4547,4550,4553,4597,4614,4657,4723,4824,4836,4858,4911,4912,4922,4959,4965,4970,4997,5072,5125,5137,5174,5175,5279,5353,5503,5516,5550,5551,5722,5780,5820,5852,5854,5876,5925,5955,6016,6071,6171,6217,6479,6521,6537,6552,6623,6687,6933,6947,6950,6968,6973,6977,7006,7191,7288,7299,7304,7305,7341,7445,7451,7461,7485,7501,7516,7735,7873,7978,8007,8012,8068,8080,8141,8195,8197,8198,8224,8271,8285,8337,8338,8374,8427,8461,8470,8592,8643,8645,8665,8681,8698,8744,8810,8831,8834,8836,8838,8843,8848,8850,8869,8870,8875,8909,8914,8922,8961,8963,8968,8975,8978,8982,8984,8987,8999,9008,9009,9022,9030,9042,9053,9059,9075,9095,9100,9104,9208,9257,9268,9271,9275,9280,9281,9282,9303,9311,9315,9331,9335,9341,9350,9357,9360,9366,9367,9378,9381,9383,9414,9430,9434,9437,9448,9455,9481,9495,9509,9515,9533,9544,9548,9552,9566,9573,9594,9613,9615,9616,9619,9620,9623,9624,9625,9631,9645,9656,9659,9667,9679,9682,9691,9693,9697,9702,9705,9707,9709,9725,9728,9729,9730,9731,9737,9741,9754,9759,9770,9772,9782,9783,9792,9793,9798,9799,9802,9813,9825,9829,9833,9869,9877,9879,9882,9884,9894,9895,9902,9913,9920,9930,9944,9945,9954,9963,10003,10008,10022,10029,10045,10053,10061,10065,10069,10072,10077,10092,10131,10133,10135,10159,10160,10163,10167,10185,10200,10212,10223,10225,10226,10253,10279,10280,10281,10283,10285,10306,10320,10329,10336,10357,10375,10383,10384,10388,10391,10398,10413,10425,10428,10431,10461,10480,10483,10496,10514,10550,10559,10577,10585,10610,10629,10632,10656,10664,10684,10685,10724,10727,10731,10740,10743,10756,10762,10764,10771,10782,10783,10796,10861,10866,10871,10877,10885,10894,10944,10955,10984,10987,10998,10999,11015,11022,11026,11033,11058,11062,11065,11096,11128,11141,11190,11208,11219,11228,11229,11237,11258,11284,11306,11324,11336,11351,11357,11358,11361,11362,11371,11375,11377,11382,11386,11412,11439,11442,11456,11458,11460,11468,11478,11495,11507,11531,11535,11560,11564,11583,11586,11588,11592,11596,11601,11615,11618,11644,11665,11667,11678,11679,11702,11804,11826,11835,11863,11866,11892,11904,11917,11935,11954,11968,11973,11975,11980,11983,12088,12103,12113,12117,12123,12138,12142,12149,12162,12192,12201,12244,12245,12247,12403,12437,12484,12612,12877,13006,13027,13072,13079,13150,13154,13184,13191,13197,13250,13279,13389,13429,13448,13460,13483,13510,13515,13538,13551,13569,13788,13807,13809,13811,13812,13820,13836,13849,13937,14033,14043,14048,14139,14156,14164,14181,14195,14283,14293,14337,14462,14576,14823,14854,14869,15028,15070,15074,15092,15158,15268,15301,15394,15644,15745,15983,15992,16028,16148,16241,16320,16353,16608,16617,16869,16871,16911,17134,17182,17339,17577,17622,17707,18041,18045,18079,18191,18206,18405,18442,18487,18501,18550,18616,18681,18777,18869,18886,19052,19457,19898,19901,19904,19959,19997,20055,20083,20296,20504,20533,20616,20764,20794,20981,21208,21338,21610,22007,22314,22479,22617,22787,22803,22820,22821,22824,22825,22832,22907,22970,22972,23168,23629,23631,24206,24418,24575,25066,25208,25212,25769,25941,26039,26268,26388,26389,26390,26618,26688,26791,27004,27205,27342,27374,27576,27578,27579,27582,28121,28211,28355,28902,29064,29076,29193,29514,29917,29920,30246,30379,31064,31166,31640,31867,31932,33196,33542,34069,34314,34335,34813,34851,35219,35689,35691,36047,36095,36419,36549,36557,36584,36586,36643,36648,36658,36668,36669,36670,36955,37233,37414,37498,37686,37707,37710,37724,37821,38033,38050,38153,38321,38358,38363,38780,38940,38985,39303,39349,39437,39514,39538,40160,40914,41283,41436,41488,42586,43213,43434,43539,43743,43931,43933,43935,43947,44040,44048,44115,44214,44555,44833,44912,44945,45138,45226,45610,45612,45650,46261,46503,46528,46529,47327,47890,47964,48138,48171,48231,48289,48309,48340,48572,49010,49018,49021,49026,49040,49047,49365,49517,49526,49527,49530,49730,49787,49950,50348,50357,50456,50497,50538,50698,50837,50839,50875,50942,51130,51497,51955,51995,52015,52451,52462,54702,55903,56292,56491,57294,57876,58233,58428,58431,58626,59961,59965,59967,60599,61012,61791,61891,62255,62630,62676,62728,62835,64559,64639,64689,64690,64720,65055,65086,65754,66195,66468,67238,67373,67913,68724,68727,68734,68812,69640,69668,70074,70435,70436,70670,70829,71469,71547,71676,71859,72190,72387,72559,72710,73567,74536,74725,74777,75174,75638,75656,75674,75780,75986,76163,76341,76487,76617,76640,76726,77016,77156,77495,77866,77883,77948,77949,77987,78381,78383,78814,79694,80278,80468,81390,81796,82505,82507,82525,82675,82682,83686,84178,84188,84204,86304,86825,87101,87421,87499,91586,92635,93856,94329,94348,97370,97614,97630,98357,98568,100241,101173,101179,102362,104755,106747,107315,107846,109091,109421,109424,109729,117251,117263,118612,118957,119450,119458,121676,127493,127867,131631,134374,134411,134597,135397,135595,136797,136835,137094,138103,138843,144336,146198,146203,146216,146233,146238,150202,150211,156022,157353,157544,157849,157909,158011,158015,162903,164457,169917,171424,176077,177677,181283,181940,184346,185567,188166,190847,190955,192102,192141,192210,193603,193756,198663,199373,204082,204922,205588,205596,205775,206197,206213,206563,207769,208763,210577,215881,216015,216282,218043,223485,224569,225574,226458,227348,227719,228066,234212,235271,238615,238636,241239,241251,241254,241257,241554,241766,242095,242166,242582,243940,244316,245846,245916,250184,253306,253626,254024,254128,254904,255343,256274,256687,256740,257088,260346,260947,262500,262543,264644,265208,266034,267860,270303,270554,271185,273481,276907,277519,277685,278316,278348,280092,280381,281730,281957,283384,283686,284536,285783,285923,286939,287948,289180,290391,290825,290864,291081,291805,296098,297596,298312,299245,299552,299553,300671,300673,301325,301365,303858,309503,309919,312791,313922,314365,316152,316727,319910,321258,322194,323271,324668,325789,326576,327833,328425,329440,329540,331190,331592,332411,332567,333371,334074,334527,336004,342502,343409,345911,347548,347755,347764,351043,352978,356483,356841,356987,360339,362765,366967,373314,375290,376004,386826,389425,433715]

        def select_random_number(sequence):
            return random.choice(sequence)

        def fetch_poster(movie_id):
            url = "https://api.themoviedb.org/3/movie/{}?api_key=c1f2ed1b9413000a1a7141f5db0b80ca&language=en-US".format(movie_id)
            data = requests.get(url)
            data = data.json()
            poster_path = data['poster_path']
            full_path = "https://image.tmdb.org/t/p/w500/" + poster_path
            return full_path
        
        def fetch_movie_details(movie_id):
            url = "https://api.themoviedb.org/3/movie/{}?api_key=c1f2ed1b9413000a1a7141f5db0b80ca&language=en-US".format(movie_id)
            data = requests.get(url)
            data = data.json()
            poster_path = "https://image.tmdb.org/t/p/w500/" + data['poster_path']
            title = data['title']
            rating = data['vote_average']
            return poster_path, title, rating

        def recommend(movie):
            index = movies[movies['title'] == movie].index[0]
            distances = sorted(list(enumerate(similarity[index])), reverse=True, key=lambda x: x[1])
            recommended_movie_names = []
            recommended_movie_posters = []
            for i in distances[1:6]:
                # fetch the movie poster
                movie_id = movies.iloc[i[0]].movie_id
                recommended_movie_posters.append(fetch_poster(movie_id))
                recommended_movie_names.append(movies.iloc[i[0]].title)

            return recommended_movie_names,recommended_movie_posters

        ###############################################################################################################################################

        selected_page = st_navbar(["Movie Recommendation System", "Genre", "Search", "Popularity", "Favorites", "Contact"])

        ###############################################################################################################################################
        if selected_page == "Movie Recommendation System":
            
            st.title("Browse Movies")

            # Display posters and titles in grid layout
            for i in range(5):
                cols = st.columns(5)
                for j in range(5):
                    poster_path, title, rating = fetch_movie_details(select_random_number(movie_ids))
                    with cols[j]:
                        st.image(poster_path, caption=f"{title} (Rating: {rating})", use_column_width=True)

        #    cols = st.columns(5)
        #    for col in cols:
        #        for i in range(5):
        #            with cols[i]:
        #                st.image(fetch_poster(select_random_number(movie_ids)))

        ###############################################################################################################################################

        elif selected_page == "Genre":
            st.header('Search Genre Films')
            genre_list = ["Adventure", "Action", "Animation", "Crime", "Comedy", "Drama", "Family", "History", "Horror", "Mystery", "Romance", "Sci-Fi", "Thriller"]
            selected_genre = st.selectbox(
                "Type or select Genres from Below",
                genre_list
            )
            if st.button('Show Movies'):
                if selected_genre == "Adventure":
                    gcols = st.columns(5)
                    count = 0
                    while(count<5):
                        for gcol in gcols:
                            for i in range(5):
                                with gcols[i]:
                                    st.image(fetch_poster(select_random_number(adv_ids)))
                        count = count + 1
                elif selected_genre == "Action":
                    gcols = st.columns(5)
                    count = 0
                    while(count<5):
                        for gcol in gcols:
                            for i in range(5):
                                with gcols[i]:
                                    st.image(fetch_poster(select_random_number(action_ids)))
                        count = count + 1
                elif selected_genre == "Animation":
                    gcols = st.columns(5)
                    count = 0
                    while(count<5):
                        for gcol in gcols:
                            for i in range(5):
                                with gcols[i]:
                                    st.image(fetch_poster(select_random_number(anime_ids)))
                        count = count + 1
                elif selected_genre == "Crime":
                    gcols = st.columns(5)
                    count = 0
                    while(count<5):
                        for gcol in gcols:
                            for i in range(5):
                                with gcols[i]:
                                    st.image(fetch_poster(select_random_number(crime_ids)))
                        count = count + 1
                elif selected_genre == "Comedy":
                    gcols = st.columns(5)
                    count = 0
                    while(count<5):
                        for gcol in gcols:
                            for i in range(5):
                                with gcols[i]:
                                    st.image(fetch_poster(select_random_number(comedy_ids)))
                        count = count + 1
                elif selected_genre == "Drama":
                    gcols = st.columns(5)
                    count = 0
                    while(count<5):
                        for gcol in gcols:
                            for i in range(5):
                                with gcols[i]:
                                    st.image(fetch_poster(select_random_number(drama_ids)))
                        count = count + 1
                elif selected_genre == "Family":
                    gcols = st.columns(5)
                    count = 0
                    while(count<5):
                        for gcol in gcols:
                            for i in range(5):
                                with gcols[i]:
                                    st.image(fetch_poster(select_random_number(fam_ids)))
                        count = count + 1
                elif selected_genre == "History":
                    gcols = st.columns(5)
                    count = 0
                    while(count<5):
                        for gcol in gcols:
                            for i in range(5):
                                with gcols[i]:
                                    st.image(fetch_poster(select_random_number(history_ids)))
                        count = count + 1
                elif selected_genre == "Romance":
                    gcols = st.columns(5)
                    count = 0
                    while(count<5):
                        for gcol in gcols:
                            for i in range(5):
                                with gcols[i]:
                                    st.image(fetch_poster(select_random_number(romance_ids)))
                        count = count + 1
                elif selected_genre == "Sci-Fi":
                    gcols = st.columns(5)
                    count = 0
                    while(count<5):
                        for gcol in gcols:
                            for i in range(5):
                                with gcols[i]:
                                    st.image(fetch_poster(select_random_number(scifi_ids)))
                        count = count + 1
                elif selected_genre == "Thriller":
                    gcols = st.columns(5)
                    count = 0
                    while(count<5):
                        for gcol in gcols:
                            for i in range(5):
                                with gcols[i]:
                                    st.image(fetch_poster(select_random_number(thriller_ids)))
                        count = count + 1
                elif selected_genre == "Horror":
                    gcols = st.columns(5)
                    count = 0
                    while(count<5):
                        for gcol in gcols:
                            for i in range(5):
                                with gcols[i]:
                                    st.image(fetch_poster(select_random_number(horror_ids)))
                        count = count + 1
                elif selected_genre == "Mystery":
                    gcols = st.columns(5)
                    count = 0
                    while(count<5):
                        for gcol in gcols:
                            for i in range(5):
                                with gcols[i]:
                                    st.image(fetch_poster(select_random_number(mystery_ids)))
                        count = count + 1

        ###############################################################################################################################################

        elif selected_page == "Search":
            st.header('Search for similar movies')
            movies = pickle.load(open(r'artifacts\movie_list.pkl','rb'))
            similarity = pickle.load(open(r'similarity.pkl','rb'))

            movie_list = movies['title'].values
            selected_movie = st.selectbox(
                "Type or select a movie from the dropdown",
                movie_list
            )

            if st.button('Show Recommendation'):
                recommended_movie_names,recommended_movie_posters = recommend(selected_movie)
                col1, col2, col3, col4, col5 = st.columns(5)
                with col1:
                    st.image(recommended_movie_posters[0])
                    st.text(recommended_movie_names[0])
                with col2:
                    st.image(recommended_movie_posters[1])
                    st.text(recommended_movie_names[1])
                with col3:
                    st.image(recommended_movie_posters[2])
                    st.text(recommended_movie_names[2])
                with col4:
                    st.image(recommended_movie_posters[3])
                    st.text(recommended_movie_names[3])
                with col5:
                    st.image(recommended_movie_posters[4])
                    st.text(recommended_movie_names[4])

        ###############################################################################################################################################

        elif selected_page == "Popularity":             
            # Load popularity models
            with open(r'artifacts\popularity_models.pkl', 'rb') as f:
                popularity_models = pickle.load(f)

            st.title("Popularity Based Movie Recommendation")

            selected_year = st.selectbox("Select a year:", sorted(popularity_models.keys()))

            if st.button("Check Popularity"):
                st.header(f"Top Popular Movies in {selected_year}:")
                top_movies = popularity_models[selected_year]
                
                # Divide the screen into columns for displaying side by side
                cols = st.columns(5)
                
                for col, (_, row) in zip(cols, top_movies.iterrows()):
                    col.image(fetch_poster(row['id']), caption=f"{row['original_title']} - Popularity: {row['popularity']}", use_column_width=True)

        ###############################################################################################################################################

        elif selected_page == "Favorites":
            st.header('Search Movies to Add to Favorites')
            movies = pickle.load(open(r'\artifacts\movie_list.pkl','rb'))
            similarity = pickle.load(open(r'similarity.pkl','rb'))

            movie_list = movies['title'].values
            selected_movie = st.selectbox(
                "Type or select a movie from the dropdown",
                movie_list
            )
            if st.button('Add to Favorites'):
                if selected_movie not in st.session_state.favorites:
                    st.session_state.favorites.append(selected_movie)
                    credentials2[st.session_state.username]["favorites"] = st.session_state.favorites
                    save_credentials2(credentials2)
                    st.success("Movie added to favorites!")
                else:
                    st.warning("This movie is already in your favorites.")
            
            # Display Favorites
            st.header("Favorites")
            favorites = st.session_state.favorites
            movies_to_remove = []  # List to store movies to be removed
            gcols = st.columns(5)
            for i, movie_title in enumerate(favorites):
                movie_id = None
                for movie in movies.itertuples():
                    if movie.title == movie_title:
                        movie_id = movie.movie_id
                        break
                if movie_id:
                    with gcols[i % 5]:
                        st.image(fetch_poster(movie_id))
                        st.text(movie_title)
                        remove_button_key = f"remove_button_{i}"
                        if st.button("Remove", key=remove_button_key):
                            movies_to_remove.append(movie_title)  # Add movie to remove list
                else:
                    st.warning(f"Movie ID not found for {movie_title}")

            # Remove movies from favorites list after loop completes
            if movies_to_remove:
                for movie_title in movies_to_remove:
                    st.session_state.favorites.remove(movie_title)
                    credentials2[st.session_state.username]["favorites"] = st.session_state.favorites
                    save_credentials2(credentials2)
                    st.success("Movie removed from favorites!")
                
                # Rerun to display the remaining favorites
                st.experimental_rerun()
                
        ###############################################################################################################################################
        
        elif selected_page == "Contact":
            st.write("# Creators")
            cont = st.columns(3)
            with cont[0]:
                st.image("Deepu.png", caption="V S S L Deepak Janapa", width= 200)
                st.write("AV.EN.U4CSE22246")
                st.write("Developed two Machine Learning Models:\n"
                        "One for accurate movie recommendations,\n"
                        "And the other for genre-specific movie recommendations. "
                        "Additionally, he integrated an API for the website, "
                        "Enhancing its functionality and providing users with dynamic content.")
                mar = st.columns(4)
                with mar[0]:
                    st.markdown('<a href="https://www.linkedin.com/in/deepakjanapa"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c9/Linkedin.svg/1200px-Linkedin.svg.png" alt="LinkedIn Logo" style="width: 32px; height: 32px;"></a>', unsafe_allow_html=True)
                with mar[1]:
                    st.markdown('<a href="https://www.instagram.com/deepak_janapa"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Instagram_icon.png/1200px-Instagram_icon.png" alt="Instagram Logo" style="width: 32px; height: 32px;"></a>', unsafe_allow_html=True)
                with mar[2]:
                    st.markdown('<a href="https://github.com/deepakjanapa"><img src="https://upload.wikimedia.org/wikipedia/commons/9/91/Octicons-mark-github.svg" alt="GitHub Logo" style="width: 32px; height: 32px; filter: invert(100%);"></a>', unsafe_allow_html=True)
                with mar[3]:
                    st.markdown('<a href="mailto:av.en.u4cse22246@av.students.amrita.edu"><img src="https://upload.wikimedia.org/wikipedia/commons/7/7e/Gmail_icon_%282020%29.svg" alt="Mail Logo" style="width: 32px; height: 32px;"></a>', unsafe_allow_html=True)
            with cont[1]:
                st.image("Venky.png", caption="Venkatesh Thanneru", width= 198)
                st.write("AV.EN.U4CSE22244")
                st.write("Developed and integrated a login page for\n "
                        "our website ensures that only authorized users\n"
                        "can access its features and content. ")
                mar = st.columns(4)
                with mar[0]:
                    st.markdown('<a href="https://www.linkedin.com/in/deepakjanapa"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c9/Linkedin.svg/1200px-Linkedin.svg.png" alt="LinkedIn Logo" style="width: 32px; height: 32px;"></a>', unsafe_allow_html=True)
                with mar[1]:
                    st.markdown('<a href="https://www.instagram.com/venky__t_"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Instagram_icon.png/1200px-Instagram_icon.png" alt="Instagram Logo" style="width: 32px; height: 32px;"></a>', unsafe_allow_html=True)
                with mar[2]:
                    st.markdown('<a href="https://github.com/deepakjanapa"><img src="https://upload.wikimedia.org/wikipedia/commons/9/91/Octicons-mark-github.svg" alt="GitHub Logo" style="width: 32px; height: 32px; filter: invert(100%);"></a>', unsafe_allow_html=True)
                with mar[3]:
                    st.markdown('<a href="mailto:av.en.u4cse22244@av.students.amrita.edu"><img src="https://upload.wikimedia.org/wikipedia/commons/7/7e/Gmail_icon_%282020%29.svg" alt="Mail Logo" style="width: 32px; height: 32px;"></a>', unsafe_allow_html=True)
            with cont[2]:
                st.image("Kavin.png", caption="R L Kavin Ragav", width=190)
                st.write("AV.EN.U4CSE22263")
                st.write("Developed frontend user Interface and\n"
                        "Integrated the model into the frontend\n"
                        "of the application, enhancing its functionality\n"
                        "and user experience. Users can now enjoy a more\n"
                        "intuitive and efficient interface")
                mar = st.columns(4)
                with mar[0]:
                    st.markdown('<a href="https://www.linkedin.com/in/deepakjanapa"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c9/Linkedin.svg/1200px-Linkedin.svg.png" alt="LinkedIn Logo" style="width: 32px; height: 32px;"></a>', unsafe_allow_html=True)
                with mar[1]:
                    st.markdown('<a href="https://www.instagram.com/"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Instagram_icon.png/1200px-Instagram_icon.png" alt="Instagram Logo" style="width: 32px; height: 32px;"></a>', unsafe_allow_html=True)
                with mar[2]:
                    st.markdown('<a href="https://github.com/deepakjanapa"><img src="https://upload.wikimedia.org/wikipedia/commons/9/91/Octicons-mark-github.svg" alt="GitHub Logo" style="width: 32px; height: 32px; filter: invert(100%);"></a>', unsafe_allow_html=True)
                with mar[3]:
                    st.markdown('<a href="mailto:av.en.u4cse22263@av.students.amrita.edu"><img src="https://upload.wikimedia.org/wikipedia/commons/7/7e/Gmail_icon_%282020%29.svg" alt="Mail Logo" style="width: 32px; height: 32px;"></a>', unsafe_allow_html=True)
            
        ###############################################################################################################################################
        sidebar(credentials2)  
        ###############################################################################################################################################
        
if __name__ == "__main__":
    main()
